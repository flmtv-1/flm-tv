<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FLM Admin Dashboard - Enhanced v008</title>
  <style>
    :root {
      --bg-dark: #121212;
      --bg-light: #1f1f1f;
      --accent: #e50914;
      --border: #333;
      --text: #fff;
      --text-light: #ccc;
    }

    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      font-family: 'Inter', Arial, sans-serif;
      background: var(--bg-dark);
      color: var(--text);
    }

    #container {
      display: flex;
      width: 100%;
      height: 100%;
    }

    .panel {
      height: 100%;
      overflow: auto;
    }

    .left-panel, .right-panel {
      width: 20%;
      min-width: 220px;
      background: var(--bg-light);
      border-right: 2px solid var(--border);
      padding: 10px;
      box-sizing: border-box;
    }

    .middle-panel {
      flex-grow: 1;
      min-width: 500px;
      background: black;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .handle {
      width: 5px;
      cursor: ew-resize;
      background: #333;
    }

    .topbar {
      background: #1c1c1c;
      padding: 5px 10px;
      border-bottom: 1px solid #333;
    }

    .topbar button {
      background: #e50914;
      border: none;
      color: white;
      padding: 6px 12px;
      margin-right: 8px;
      cursor: pointer;
      font-weight: bold;
      border-radius: 4px;
    }

    .topbar button:hover {
      background: #ff1a1a;
    }

    input, textarea, select {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      background: #2a2a2a;
      border: 1px solid #555;
      color: white;
      box-sizing: border-box;
      border-radius: 4px;
    }

    .btn {
      background: var(--accent);
      border: none;
      padding: 12px;
      color: white;
      cursor: pointer;
      width: 100%;
      margin-bottom: 10px;
      font-weight: bold;
      border-radius: 6px;
    }

    .btn:hover {
      background: #ff1a1a;
    }

    .tabContent {
      display: none;
    }

    .tabContent.active {
      display: block;
    }

    .meta-preview {
      background: #1f1f1f;
      border: 1px solid #444;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
    }

    .meta-preview img {
      max-width: 100%;
      margin-bottom: 10px;
      border-radius: 4px;
    }

    .meta-preview .title {
      font-size: 18px;
      font-weight: bold;
    }

    .meta-preview .info {
      margin-bottom: 5px;
    }

    .caption-output {
      background: #1f1f1f;
      padding: 10px;
      border: 1px solid var(--border);
      white-space: pre-wrap;
      height: 180px;
      overflow-y: auto;
      border-radius: 6px;
    }

    .caption-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .caption-controls select {
      flex: 1;
    }

    .video-preview {
      width: 100%;
      height: 300px;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--text-light);
      border: 1px solid var(--border);
      border-radius: 6px;
    }

    /* ğŸ¯ Sidebar Tab Buttons */
    .left-panel button {
      width: 100%;
      margin-bottom: 10px;
      padding: 12px;
      background: var(--accent);
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      text-align: left;
    }

    .left-panel button:hover {
      background: #ff1a1a;
    }

  </style>
</head>
<body>
  <!-- ğŸš€ Top Toolbar -->
  <div class="topbar">
    <button onclick="togglePanel('left')">ğŸ§² Toggle Left Panel</button>
    <button onclick="togglePanel('right')">ğŸ§² Toggle Right Panel</button>
    <button onclick="resetPanels()">ğŸ”„ Reset Layout</button>
  </div>

  <!-- ğŸ’» Panel Layout -->
  <div id="container">
    <!-- ğŸ“‚ LEFT PANEL: Admin Menu -->
    <div class="panel left-panel" id="leftPanel">
      <h3>ğŸ“ Admin Menu</h3>
      <button onclick="showTab('addMedia')">ğŸ¬ Add Media</button>
      <button onclick="showTab('metadataAI')">ğŸ§  Metadata AI</button>
      <button onclick="showTab('themeLogo')">ğŸ¨ Theme + Logo</button>
      <button onclick="showTab('categoryManager')">ğŸ—‚ï¸ Categories</button>
      <button onclick="showTab('tvSeriesTab')">ğŸ“º TV Series</button>
      <button onclick="showTab('aiCaptions')">ğŸ“ AI Captions</button>
      <button onclick="showTab('aiCaptionsTab')">ğŸŒ Caption Translations</button>
      <button onclick="showTab('lumaTab')">ğŸ¤– LUMA AI</button>
    </div>

    <!-- ğŸ¤ Left Panel Resize Handle -->
    <div class="handle" id="leftHandle" onmousedown="startResize(event, 'left')"></div>

    <!-- ğŸ–¥ï¸ MIDDLE PANEL: Streaming App Preview -->
    <div class="panel middle-panel">
      <iframe id="viewerFrame" src="../flm-viewer/index.html"></iframe>
    </div>

    <!-- ğŸ¤ Right Panel Resize Handle -->
    <div class="handle" id="rightHandle" onmousedown="startResize(event, 'right')"></div>

    <!-- ğŸ›ï¸ RIGHT PANEL: Tab Content Display -->
    <div class="panel right-panel" id="rightPanel">

      <!-- ğŸ¬ Add Media -->
      <div class="tabContent active" id="addMedia">
        <h2>ğŸ“‹ Add Media</h2>
        <input id="title" placeholder="ğŸï¸ Title" />
        <textarea id="description" placeholder="ğŸ“ Description..."></textarea>
        <input id="videoUrl" placeholder="ğŸ¥ Video URL" />
        <input id="posterUrl" placeholder="ğŸ–¼ï¸ Poster URL" />
        <input id="genre" placeholder="ğŸ­ Genre" />
        <input id="year" placeholder="ğŸ“… Year" />
        <input id="cast" placeholder="ğŸ­ Cast" />
        <input id="director" placeholder="ğŸ¬ Director" />
        <button class="btn" onclick="sendToViewer()">ğŸš€ Send to Viewer</button>
      </div>

      <!-- ğŸ§  Metadata AI -->
      <div class="tabContent" id="metadataAI">
        <h2>ğŸ” Metadata AI Lookup</h2>
        <input id="lookupTitle" placeholder="ğŸï¸ Enter movie/show title" />
        <button class="btn" onclick="fetchMetadata()">ğŸ“¡ Fetch Metadata</button>
        <div class="meta-preview" id="metaResult"></div>
      </div>

      <!-- ğŸ¨ Theme + Logo -->
      <div class="tabContent" id="themeLogo">
        <h2>ğŸ¨ Theme + Logo</h2>
        <label>ğŸ“¥ Upload Logo</label>
        <input type="file" accept="image/*" onchange="previewLogo(this)" />
        <div id="logoPreview" style="margin-top:10px;"></div>

        <label>ğŸ¨ Primary Color</label>
        <input type="color" id="themeColor" value="#e50914" />

        <label>ğŸ”¤ Font Style</label>
        <select id="themeFont">
          <option value="Arial">Arial</option>
          <option value="Inter" selected>Inter</option>
          <option value="Georgia">Georgia</option>
          <option value="Courier New">Courier New</option>
        </select>

        <label>ğŸ“ Footer Text</label>
        <input type="text" id="footerText" placeholder="Â© 2025 FLM TV" />

        <label>ğŸ  Homepage Intro Text</label>
        <textarea id="homeIntro" placeholder="Welcome to FLM TV!"></textarea>

        <label>ğŸ”— Optional Hyperlink</label>
        <input type="text" id="footerLinkText" placeholder="Link Text (e.g. Visit Us)" />
        <input type="url" id="footerLinkURL" placeholder="https://example.com" />

        <button class="btn" onclick="applyThemeSettings()">ğŸ¯ Apply Theme</button>
      </div>

      <!-- ğŸ—‚ï¸ Category Manager -->
      <div class="tabContent" id="categoryManager">
        <h2>ğŸ—‚ï¸ Manage Categories</h2>
        <input id="newCategory" placeholder="ğŸ“ New Category (e.g. Classic Films)" />
        <button class="btn" onclick="addCategory()">â• Add Category</button>
        <div id="categoryList" style="margin-top: 20px;"></div>
      </div>
      <!-- ğŸ“º TV Series Manager -->
      <div class="tabContent" id="tvSeriesTab">
        <h2>ğŸ“º TV Series Manager</h2>
        <label>ğŸï¸ Series Title</label>
        <input id="seriesTitle" placeholder="Enter series name" />
        <label>ğŸ“… Season</label>
        <input id="seasonNumber" type="number" min="1" placeholder="e.g. 1" />
        <label>ğŸ“º Episode Number</label>
        <input id="episodeNumber" type="number" min="1" placeholder="e.g. 1" />
        <label>ğŸ¬ Episode Title</label>
        <input id="episodeTitle" placeholder="Episode title" />
        <label>ğŸ¥ Episode Video URL</label>
        <input id="episodeVideoUrl" placeholder="Paste video URL" />
        <label>ğŸ–¼ï¸ Poster Image URL</label>
        <input id="episodePoster" placeholder="Poster image URL" />
        <button class="btn" onclick="addTvEpisode()">â• Add Episode</button>
        <div class="meta-preview" id="tvSeriesPreview" style="margin-top: 20px;"></div>
      </div>

      <!-- ğŸ“ AI Captions Generator -->
      <div class="tabContent" id="aiCaptions">
        <h2>ğŸ“ AI Caption Generator</h2>
        <p>Automatically generate captions for your video using AI.</p>
        <div class="caption-controls">
          <select id="wordCount">
            <option value="8">8 words</option>
            <option selected value="10">10 words</option>
            <option value="15">15 words</option>
            <option value="20">20 words</option>
          </select>
          <select id="language">
            <option value="en">ğŸ‡ºğŸ‡¸ English</option>
            <option value="es">ğŸ‡ªğŸ‡¸ Spanish</option>
            <option value="fr">ğŸ‡«ğŸ‡· French</option>
            <option value="tl">ğŸ‡µğŸ‡­ Filipino</option>
          </select>
        </div>
        <input id="videoUrl" placeholder="ğŸ¥ Video URL for captioning" />
        <div class="video-preview" id="videoPlayer">
          No video selected for captioning.
        </div>
        <div style="margin-top: 10px;">
          <button class="btn" onclick="startCaptions()">â–¶ Start Captioning</button>
          <button class="btn" onclick="stopCaptions()">â¹ Stop Captioning</button>
        </div>
        <div class="section">
          <h3>ğŸ§¾ Generated Captions (Preview)</h3>
          <div class="caption-output" id="captionResults">
            Captions will appear here.
          </div>
        </div>
      </div>

      <!-- ğŸŒ Caption Translations -->
      <div class="tabContent" id="aiCaptionsTab">
        <h2>ğŸŒ Translate Captions (.vtt)</h2>
        <label>ğŸ“¤ Upload English .vtt File</label>
        <input id="vttFileUpload" type="file" accept=".vtt" />
        <label>ğŸŒ Select Languages to Translate</label>
        <select id="translationLanguages" multiple size="8" style="width: 100%;">
          <option value="es">ğŸ‡ªğŸ‡¸ Spanish</option>
          <option value="fr">ğŸ‡«ğŸ‡· French</option>
          <option value="de">ğŸ‡©ğŸ‡ª German</option>
          <option value="zh">ğŸ‡¨ğŸ‡³ Chinese</option>
          <option value="ja">ğŸ‡¯ğŸ‡µ Japanese</option>
          <option value="hi">ğŸ‡®ğŸ‡³ Hindi</option>
          <option value="ru">ğŸ‡·ğŸ‡º Russian</option>
          <option value="pt">ğŸ‡µğŸ‡¹ Portuguese</option>
          <option value="ar">ğŸ‡¸ğŸ‡¦ Arabic</option>
          <option value="it">ğŸ‡®ğŸ‡¹ Italian</option>
        </select>
        <button class="btn" onclick="generateTranslatedCaptions()">ğŸŒ Translate Captions</button>
        <div class="meta-preview" id="captionPreviewOutput" style="margin-top: 20px;"></div>
      </div>

      <!-- ğŸ¤– LUMA AI Search -->
      <div class="tabContent" id="lumaTab">
        <h2>ğŸ¤– LUMA AI Assistant</h2>
        <p>Search YouTube for trailers, auto-fill metadata, and preview posters.</p>
        <label>ğŸ¬ Search Film or Trailer:</label>
        <input id="lumaSearch" placeholder="Enter film title..." />
        <button class="btn" onclick="searchYouTube()">ğŸ” Search YouTube</button>
        <div id="lumaResults" style="margin-top: 20px;"></div>
      </div>

    </div> <!-- ğŸ§± End Right Panel -->
  </div> <!-- ğŸ§± End Container -->
<!-- ğŸ”½ JAVASCRIPT MAGIC STARTS HERE -->
<script>
  const OMDB_API_KEY = "266aeb44";
  let currentMetaData = null;
  let captionExpanded = false;
  let tvSeriesData = {};
  let categories = [];

  // ğŸ¯ Panel Resizing
  function startResize(e, handle) {
    const move = (e) => {
      if (handle === "left") {
        document.getElementById("leftPanel").style.width = Math.max(220, e.clientX) + "px";
      } else {
        const w = window.innerWidth;
        document.getElementById("rightPanel").style.width = Math.max(220, w - e.clientX) + "px";
      }
    };
    const stop = () => {
      document.removeEventListener("mousemove", move);
      document.removeEventListener("mouseup", stop);
    };
    document.addEventListener("mousemove", move);
    document.addEventListener("mouseup", stop);
  }

  // ğŸ§© Panel Toggle Logic
  function togglePanel(panel) {
    const el = document.getElementById(panel + "Panel");
    const handle = document.getElementById(panel + "Handle");
    const isVisible = el.style.display !== "none";
    el.style.display = isVisible ? "none" : "block";
    handle.style.display = isVisible ? "none" : "block";
  }

  function resetPanels() {
    ["leftPanel", "rightPanel", "leftHandle", "rightHandle"].forEach(id => {
      const el = document.getElementById(id);
      el.style.display = "block";
    });
    document.getElementById("leftPanel").style.width = "20%";
    document.getElementById("rightPanel").style.width = "20%";
  }

  // ğŸ—‚ï¸ Tab Navigation
  function showTab(tabId) {
    document.querySelectorAll('.tabContent').forEach(t => t.classList.remove("active"));
    const tab = document.getElementById(tabId);
    if (tab) tab.classList.add("active");
  }

  // ğŸš€ Send Media to Streaming App
  function sendToViewer() {
    const data = {
      title: document.getElementById("title").value,
      description: document.getElementById("description").value,
      video: document.getElementById("videoUrl").value,
      poster: document.getElementById("posterUrl").value,
      genre: document.getElementById("genre").value,
      year: document.getElementById("year").value,
      cast: document.getElementById("cast").value,
      director: document.getElementById("director").value
    };
    document.getElementById("viewerFrame").contentWindow.postMessage({ type: "updateMedia", ...data }, "*");
  }

  // ğŸ§  Fetch Metadata from OMDb
  async function fetchMetadata() {
    const title = document.getElementById("lookupTitle").value.trim();
    const resultDiv = document.getElementById("metaResult");
    resultDiv.innerHTML = "ğŸ” Searching...";
    if (!title) return;

    const res = await fetch(`https://www.omdbapi.com/?apikey=${OMDB_API_KEY}&t=${encodeURIComponent(title)}`);
    const data = await res.json();

    if (data.Response === "False") {
      resultDiv.innerHTML = "âŒ Not found.";
      return;
    }

    currentMetaData = data;

    resultDiv.innerHTML = `
      <img src="${data.Poster}" alt="Poster">
      <div class="title">${data.Title} (${data.Year})</div>
      <div class="info"><strong>Genre:</strong> ${data.Genre}</div>
      <div class="info"><strong>Director:</strong> ${data.Director}</div>
      <div class="info"><strong>Cast:</strong> ${data.Actors}</div>
      <div class="info"><strong>Plot:</strong> ${data.Plot}</div>
      <button class="btn" onclick="useMetaData()">âœ”ï¸ Use This</button>
    `;
  }

  function useMetaData() {
    if (!currentMetaData) return;
    document.getElementById("title").value = currentMetaData.Title || "";
    document.getElementById("description").value = currentMetaData.Plot || "";
    document.getElementById("posterUrl").value = currentMetaData.Poster || "";
    document.getElementById("genre").value = currentMetaData.Genre || "";
    document.getElementById("year").value = currentMetaData.Year || "";
    document.getElementById("cast").value = currentMetaData.Actors || "";
    document.getElementById("director").value = currentMetaData.Director || "";
    showTab('addMedia');
  }

  // ğŸ“ Caption Generator (Preview Only)
  function startCaptions() {
    const url = document.getElementById("videoUrl").value;
    const lang = document.getElementById("language").value;
    const words = document.getElementById("wordCount").value;

    if (!url) {
      alert("Please enter a video URL first.");
      return;
    }

    document.getElementById("videoPlayer").innerHTML = `
      <video width="100%" height="100%" controls>
        <source src="${url}" type="video/mp4">
        Your browser does not support the video tag.
      </video>`;

    document.getElementById("captionResults").innerText =
      "[00:00:01.000 --> 00:00:04.000] This is an example caption in " + lang + " with " + words + " words.\n[00:00:05.000 --> 00:00:08.000] More captions will appear here.";
  }

  function stopCaptions() {
    alert("ğŸ›‘ Captioning stopped.");
  }

  // ğŸŒ VTT Caption Translator (Preview Only)
  function generateTranslatedCaptions() {
    const fileInput = document.getElementById('vttFileUpload');
    const langs = Array.from(document.getElementById('translationLanguages').selectedOptions).map(opt => opt.value);
    const outputDiv = document.getElementById('captionPreviewOutput');

    if (!fileInput.files.length) {
      alert("ğŸ“‚ Please upload a .vtt file.");
      return;
    }

    if (!langs.length) {
      alert("ğŸŒ Please select at least one language to translate.");
      return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function (e) {
      const baseText = e.target.result;
      outputDiv.innerHTML = "<h4>Preview of Translated Captions:</h4>";

      langs.forEach(lang => {
        const block = document.createElement("div");
        block.style.marginBottom = "20px";
        block.innerHTML = `<strong>${lang.toUpperCase()}</strong><pre>[Translated .vtt for ${lang} would appear here]</pre>`;
        outputDiv.appendChild(block);
      });
    };
    reader.readAsText(file);
  }

  // ğŸ¨ Theme + Logo Preview + Send to Viewer
  function previewLogo(input) {
    const preview = document.getElementById("logoPreview");
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = function (e) {
        preview.innerHTML = `<img src="${e.target.result}" style="max-height:60px;">`;
      };
      reader.readAsDataURL(input.files[0]);
    }
  }

  function applyThemeSettings() {
    const color = document.getElementById("themeColor").value;
    const font = document.getElementById("themeFont").value;
    const footer = document.getElementById("footerText").value;
    const intro = document.getElementById("homeIntro").value;
    const linkText = document.getElementById("footerLinkText").value;
    const linkURL = document.getElementById("footerLinkURL").value;

    const themeData = {
      color,
      font,
      footer,
      intro,
      linkText,
      linkURL
    };

    document.getElementById("viewerFrame").contentWindow.postMessage({ type: "applyTheme", ...themeData }, "*");
    alert("ğŸ¨ Theme applied!");
  }

  // ğŸ—‚ï¸ Category Manager
  function addCategory() {
    const newCat = document.getElementById("newCategory").value.trim();
    if (!newCat) return;
    if (categories.includes(newCat)) {
      alert("âš ï¸ Category already exists.");
      return;
    }
    categories.push(newCat);
    renderCategoryList();
    document.getElementById("newCategory").value = "";
  }

  function renderCategoryList() {
    const container = document.getElementById("categoryList");
    container.innerHTML = "";
    categories.forEach((cat, i) => {
      const row = document.createElement("div");
      row.innerHTML = `
        <span>${cat}</span>
        <button style="float:right; background:#900;" onclick="removeCategory(${i})">ğŸ—‘ï¸ Delete</button>
      `;
      container.appendChild(row);
    });
  }

  function removeCategory(index) {
    categories.splice(index, 1);
    renderCategoryList();
  }

  // ğŸ¤– LUMA AI: YouTube Trailer Search
  async function searchYouTube() {
    const query = document.getElementById('lumaSearch').value;
    const resultDiv = document.getElementById('lumaResults');
    resultDiv.innerHTML = 'ğŸ” Searching...';

    const apiKey = 'AIzaSyBJMZDXDPcVPUFhMKdYrABrke4PQZgRsT8';
    const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&maxResults=5&key=${apiKey}`;

    const res = await fetch(url);
    const data = await res.json();

    resultDiv.innerHTML = "";
    if (data.items) {
      data.items.forEach(item => {
        const videoId = item.id.videoId;
        const title = item.snippet.title;
        const thumb = item.snippet.thumbnails.medium.url;
        const desc = item.snippet.description;

        const div = document.createElement("div");
        div.innerHTML = `
          <div style='margin-bottom: 15px; padding: 10px; border: 1px solid #333; background: #1f1f1f;'>
            <img src="${thumb}" style="width: 200px; float: left; margin-right: 15px;">
            <strong>${title}</strong><br><br>
            <small>${desc}</small><br><br>
            <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank">â–¶ Watch on YouTube</a>
            <div style='clear:both;'></div>
          </div>`;
        resultDiv.appendChild(div);
      });
    } else {
      resultDiv.innerHTML = 'âŒ No results found.';
    }
  }

  // ğŸ“º TV Series Manager
  function addTvEpisode() {
    const title = document.getElementById("seriesTitle").value.trim();
    const season = document.getElementById("seasonNumber").value.trim();
    const episode = document.getElementById("episodeNumber").value.trim();
    const epTitle = document.getElementById("episodeTitle").value.trim();
    const video = document.getElementById("episodeVideoUrl").value.trim();
    const poster = document.getElementById("episodePoster").value.trim();

    if (!title || !season || !episode || !video || !epTitle) {
      alert("âš ï¸ Please fill in all required fields.");
      return;
    }

    if (!tvSeriesData[title]) tvSeriesData[title] = {};
    if (!tvSeriesData[title][season]) tvSeriesData[title][season] = [];

    tvSeriesData[title][season].push({
      episode: parseInt(episode),
      title: epTitle,
      video,
      poster
    });

    renderTvSeriesPreview();
  }

  function renderTvSeriesPreview() {
    const container = document.getElementById("tvSeriesPreview");
    container.innerHTML = "";

    for (const series in tvSeriesData) {
      const sDiv = document.createElement("div");
      sDiv.innerHTML = `<h3>${series}</h3>`;
      for (const season in tvSeriesData[series]) {
        const seasonDiv = document.createElement("div");
        seasonDiv.innerHTML = `<strong>Season ${season}:</strong><ul></ul>`;
        const ul = seasonDiv.querySelector("ul");

        tvSeriesData[series][season]
          .sort((a, b) => a.episode - b.episode)
          .forEach(ep => {
            const li = document.createElement("li");
            li.innerText = `Episode ${ep.episode}: ${ep.title}`;
            ul.appendChild(li);
          });

        sDiv.appendChild(seasonDiv);
      }
      container.appendChild(sDiv);
    }
  }
</script>
</body>
</html>



