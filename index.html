<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FLM TV - Part 2: Visual Categories</title>
    <!-- CSP removed to allow Castr stream -->
    <link rel="icon" type="image/png" href="assets/logos/flm-logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  VARIABLES - Filipino Flag Colors                               */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        :root {
            /* FLM TV Brand Colors */
            --primary: #ffd700;        /* Gold */
            --secondary: #22c55e;      /* Green */
            --accent: #ffd700;         /* Gold accent */
            --neon-green: #22c55e;     /* Neon Green */
            --bg: #0a0f1a;             /* Deep blue-black */
            --bg-light: #1a1f2e;       /* Lighter blue */
            --bg-card: #1a1f2e;        /* Card background */
            --text: #ffffff;           /* White text */
            --text-secondary: #94a3b8; /* Gray text */
            --border: #334155;         /* Borders */
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  RESET & BASE                                                   */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            transition: padding-right 0.3s ease;
        }

        /* Push content left when panel is open */
        body.panel-active {
            padding-right: 450px;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  HEADER                                                         */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 1rem 2rem;
        }
        
        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo-container img {
            height: 50px;
            width: auto;
            border-radius: 8px;
        }
        
        .logo-text {
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header-nav {
            display: flex;
            gap: 2rem;
            list-style: none;
        }
        
        .header-nav a {
            color: var(--text);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: color 0.3s ease;
            position: relative;
        }
        
        .header-nav a:hover {
            color: var(--neon-green);
        }
        
        .header-nav a.active {
            color: var(--accent);
        }
        
        .header-nav a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--neon-green);
        }
        
        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .btn-icon {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--neon-green);
            color: var(--neon-green);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }
        
        .btn-icon:hover {
            background: var(--neon-green);
            color: white;
            transform: scale(1.1);
        }
        
        /* Buttons with text labels - pill shaped */
        .btn-icon-text {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--neon-green);
            color: var(--neon-green);
            width: auto;
            padding: 0.6rem 1.25rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .btn-icon-text:hover {
            background: var(--neon-green);
            color: white;
            transform: scale(1.05);
        }
        
        .btn-icon-text i {
            font-size: 1.1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: #000;  /* Black text on gold */
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  HERO BANNER                                                    */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .hero-banner {
            height: 70vh;
            position: relative;
            overflow: hidden;
        }
        
        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
        }
        
        .hero-slide.active {
            opacity: 1;
        }
        
        .hero-slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(15, 23, 42, 0.3), rgba(15, 23, 42, 0.9));
        }
        
        .hero-content {
            position: absolute;
            bottom: 10%;
            left: 5%;
            max-width: 600px;
            z-index: 2;
            color: white;
        }
        
        .hero-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 1rem;
            color: var(--accent);
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
        }
        
        .hero-description {
            font-size: 1.25rem;
            color: white;
            margin-bottom: 2rem;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.8);
            line-height: 1.6;
        }
        
        .hero-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-hero-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-hero-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(206, 17, 38, 0.4);
        }
        
        .btn-hero-secondary {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            border: 2px solid var(--neon-green);
        }
        
        .btn-hero-secondary:hover {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--neon-green);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  CATEGORY NAVIGATION                                            */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .category-nav-section {
            background: var(--bg-light);
            padding: 2rem;
            border-bottom: 2px solid var(--primary);
        }
        
        .category-nav-container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .category-nav-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 1.5rem;
        }
        
        .category-nav-wrapper {
            position: relative;
        }
        
        .category-nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(15, 23, 42, 0.9);
            border: 3px solid var(--neon-green);
            color: var(--neon-green);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .category-nav-arrow:hover {
            background: var(--neon-green);
            color: white;
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 0 20px var(--neon-green);
        }
        
        .category-nav-arrow.left {
            left: -25px;
        }
        
        .category-nav-arrow.right {
            right: -25px;
        }
        
        .category-nav-scroll {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0 1rem 0;
            scroll-behavior: smooth;
            scrollbar-width: none;
        }
        
        .category-nav-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .category-nav-item {
            flex: 0 0 250px;
            height: 140px;
            position: relative;
            cursor: pointer;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }
        
        .category-nav-item:hover {
            transform: scale(1.05);
            border-color: var(--neon-green);
            box-shadow: 0 8px 24px rgba(34, 197, 94, 0.3);
        }
        
        .category-nav-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .category-nav-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
            display: flex;
            align-items: flex-end;
            padding: 1rem;
        }
        
        .category-nav-name {
            font-size: 1.1rem;
            font-weight: 800;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  CONTENT SECTIONS                                               */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .content-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .category-section {
            margin-bottom: 3rem;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .category-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--accent);
        }
        
        .view-all-btn {
            color: var(--neon-green);
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .view-all-btn:hover {
            gap: 0.75rem;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  CONTENT CAROUSEL                                               */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .content-carousel {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 0.5rem 0 1rem 0;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: var(--neon-green) var(--bg-light);
        }
        
        .content-carousel::-webkit-scrollbar {
            height: 8px;
        }
        
        .content-carousel::-webkit-scrollbar-track {
            background: var(--bg-light);
            border-radius: 4px;
        }
        
        .content-carousel::-webkit-scrollbar-thumb {
            background: var(--neon-green);
            border-radius: 4px;
        }
        
        .content-card {
            flex: 0 0 200px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .content-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.6),
                        0 0 60px rgba(34, 197, 94, 0.4),
                        0 8px 25px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--neon-green);
        }
        
        .content-card-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 8px;
            background: var(--bg-card);
        }
        
        .content-card-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.85) 70%, transparent 100%);
            padding: 1rem;
            border-radius: 0 0 8px 8px;
        }
        
        .content-card-title {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        .content-card-info {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  LOADING STATE                                                  */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            gap: 1rem;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--bg-light);
            border-top-color: var(--neon-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        /* Floating Chat/AI buttons that appear ONLY during video playback */
        /* Floating Chat/AI buttons for main page */
        .floating-buttons {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 10001;
            transition: right 0.3s ease;
        }
        
        body.panel-active .floating-buttons {
            right: 470px;
        }
        
        .floating-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
        }
        
        .floating-btn-chat {
            background: var(--neon-green);
            color: white;
        }
        
        .floating-btn-ai {
            background: linear-gradient(135deg, var(--neon-green) 0%, var(--accent) 100%);
            padding: 0;
            overflow: hidden;
            border: 3px solid var(--neon-green);
        }
        
        .floating-btn-ai img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        /* Hide floating buttons when viewer is active */
        .jellyfin-viewer.active ~ .floating-buttons {
            display: none;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  MODALS                                                         */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            border: 2px solid var(--primary);
            animation: slideUp 0.3s ease;
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.75rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: var(--neon-green);
            color: white;
            transform: rotate(90deg);
        }
        
        .modal-body {
            margin-bottom: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg);
            border: 2px solid var(--primary);
            border-radius: 8px;
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--neon-green);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        .modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        .btn-modal {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-modal-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
        }
        
        .btn-modal-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(252, 209, 22, 0.3);
        }
        
        .btn-modal-secondary {
            background: var(--bg-light);
            color: var(--text);
            border: 2px solid var(--neon-green);
        }
        
        .btn-modal-secondary:hover {
            background: rgba(34, 197, 94, 0.1);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  SIDE PANELS (Chat & AI)                                        */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .side-panel {
            position: fixed;
            right: -100%;
            top: 0;
            width: 100%;
            max-width: 450px;
            height: 100vh;
            background: var(--bg-card);
            border-left: 3px solid var(--primary);
            z-index: 9998;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .side-panel.active {
            right: 0;
        }
        
        .panel-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--neon-green);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(15, 23, 42, 0.95);
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--neon-green);
        }
        
        .panel-close {
            background: none;
            border: none;
            color: var(--neon-green);
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .panel-close:hover {
            background: var(--neon-green);
            color: white;
            transform: rotate(90deg);
        }
        
        .panel-toggle {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .panel-toggle:hover {
            background: var(--primary);
            color: white;
        }
        
        /* Fullscreen panel mode */
        .side-panel.panel-fullscreen {
            width: 100% !important;
            max-width: 100% !important;
        }
        
        .panel-body {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  FLOATING BUTTONS (Chat & AI)                                   */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  JELLYFIN VIEWER FRAME                                         */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .jellyfin-viewer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000;
            z-index: 9999;
            display: none;
            flex-direction: column;
            transition: right 0.3s ease;
        }
        
        .jellyfin-viewer.active {
            display: flex;
        }
        
        /* Push viewer left when panel opens */
        body.panel-active .jellyfin-viewer {
            right: 450px;
        }
        
        .viewer-header {
            background: rgba(15, 23, 42, 0.98);
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary);
            z-index: 10000;
            position: sticky;
            top: 0;
            pointer-events: auto;
            gap: 1rem;
            min-height: 60px;
            max-height: 60px;
        }
        
        /* KEEP FLM TV header visible - we'll hide Jellyfin's header instead */
        .jellyfin-viewer.viewing-movie .viewer-header {
            display: flex; /* Keep it visible */
        }
        
        /* Account for FLM TV header height */
        .jellyfin-viewer.viewing-movie iframe {
            height: calc(100vh - 60px); /* 60px for FLM TV header */
        }
        
        .viewer-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-shrink: 0;
        }
        
        .viewer-logo img {
            height: 32px;
        }
        
        .viewer-logo span {
            font-size: 1.25rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .viewer-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
            justify-content: flex-end;
        }
        
        .btn-icon {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--neon-green);
            color: white;
            padding: 0.65rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        
        .btn-icon:hover {
            background: var(--neon-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
        }
        
        .viewer-chat-btn,
        .viewer-ai-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--accent);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .viewer-chat-btn:hover,
        .viewer-ai-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(252, 209, 22, 0.4);
        }
        
        .viewer-back {
            background: var(--neon-green);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            z-index: 9999; /* Make sure it's above everything */
            position: relative;
            min-width: 44px; /* Minimum touch target */
            min-height: 44px;
        }
        
        .viewer-back:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
        }
        
        .viewer-close {
            background: var(--secondary);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .viewer-close:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(206, 17, 38, 0.4);
        }
        
        #jellyfinFrame {
            flex: 1;
            width: 100%;
            height: 100%;
            border: none;
            background: #000;
        }
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--neon-green) 0%, var(--accent) 100%);
            color: var(--bg);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        
        .floating-btn-ai:hover::after {
            opacity: 1;
            right: 75px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  LIVE TV MODAL                                                  */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        
        
        
        
        .live-tv-content {
            width: 95%;
            max-width: 1000px;
            position: relative;
            max-height: 90vh;
        }
        
        .live-tv-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .live-tv-title {
            color: var(--secondary);
            font-size: 1.5rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  MOBILE-FIRST MOVIE CARDS (Works Worldwide!)                    */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        /* BASE: MOBILE (320px+) - Starts small for ALL phones */
        .movie-card {
            flex: 0 0 105px !important;
            min-width: 105px !important;
            max-width: 105px !important;
            margin: 0;
            cursor: pointer;
            transition: transform 0.2s ease;
            scroll-snap-align: start;
        }
        
        .movie-poster {
            width: 100%;
            height: 158px !important;  /* 3:2 ratio - Tubi size */
            object-fit: cover;
            border-radius: 4px;
        }
        
        .movie-info {
            padding: 0.4rem 0.2rem;
        }
        
        .movie-title {
            font-size: 0.7rem;
            line-height: 1.1;
            font-weight: 600;
            margin-bottom: 0.2rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .movie-year,
        .movie-rating {
            font-size: 0.65rem;
            color: var(--text-secondary);
        }
        
        /* Movies scroll container */
        .movies-scroll {
            display: flex;
            gap: 0.4rem;
            padding: 0 0.75rem;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x proximity;
            scrollbar-width: none;
        }
        
        .movies-scroll::-webkit-scrollbar {
            display: none;
        }
        
        /* TABLET (768px+) - Make bigger */
        @media (min-width: 768px) {
            .movie-card {
                flex: 0 0 150px !important;
                min-width: 150px !important;
                max-width: 150px !important;
            }
            
            .movie-poster {
                height: 225px !important;
            }
            
            .movie-title {
                font-size: 0.85rem !important;
            }
        }
        
        /* DESKTOP (1024px+) - Even bigger */
        @media (min-width: 1024px) {
            .movie-card {
                flex: 0 0 200px !important;
                min-width: 200px !important;
                max-width: 200px !important;
            }
            
            .movie-poster {
                height: 300px !important;
            }
            
            .movie-title {
                font-size: 1rem !important;
            }
            
            .movie-info {
                padding: 0.5rem 0.25rem !important;
            }
        }
        
        /* LARGE DESKTOP (1440px+) - Maximum size */
        @media (min-width: 1440px) {
            .movie-card {
                flex: 0 0 220px !important;
                min-width: 220px !important;
                max-width: 220px !important;
            }
            
            .movie-poster {
                height: 330px !important;
            }
        }
        
        @media (max-width: 768px) {
            .live-tv-title {
                font-size: 1.2rem;
            }
        }
        
        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: var(--secondary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .close-live-tv {
            background: var(--secondary);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        @media (max-width: 768px) {
            .close-live-tv {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }
        
        .close-live-tv:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(206, 17, 38, 0.4);
        }
        
        .live-tv-player {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            background: #000;
            border-radius: 12px;
            border: 3px solid var(--accent);
        }
        
        .live-tv-player iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  LIVE CHANNEL 26.5 CARD                                         */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .live-channel-card {
            flex: 0 0 350px;
            height: 200px;
            position: relative;
            cursor: pointer;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 3px solid var(--secondary);
            background: #000;
            box-shadow: 0 8px 24px rgba(206, 17, 38, 0.4);
        }
        
        .live-channel-card:hover {
            transform: scale(1.05);
            border-color: var(--neon-green);
            box-shadow: 0 12px 32px rgba(34, 197, 94, 0.5);
        }
        
        .live-preview-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .live-channel-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 65px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0.75rem 1.25rem;
            background: linear-gradient(135deg, rgba(206, 17, 38, 0.85) 0%, rgba(139, 0, 0, 0.85) 100%);
            backdrop-filter: blur(5px);
        }
        
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 800;
            margin-bottom: 0.35rem;
            color: white;
        }
        
        .live-dot {
            width: 8px;
            height: 8px;
            background: #ff0000;
            border-radius: 50%;
            animation: livePulse 1.5s infinite;
            box-shadow: 0 0 10px #ff0000;
        }
        
        /* Volume Toggle Button */
        
        
        
            50% { opacity: 0.5; transform: scale(1.2); }
        }
        
        .live-channel-name {
            font-size: 1.1rem;
            font-weight: 900;
            color: white;
            margin-bottom: 0rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            line-height: 1.2;
            letter-spacing: 0.5px;
        }
        
        .live-channel-description {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.85);
            display: none;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  LIVE VIDEO MODAL                                               */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            transition: padding-right 0.3s ease;
        }
        
        .video-modal.active {
            display: flex;
        }
        
        /* Push video left when panel opens */
        body.panel-active .video-modal {
            padding-right: 450px;
        }
        
        .video-container {
            width: 95%;
            max-width: 1600px;
            position: relative;
            aspect-ratio: 16/9;
        }
        
        .video-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .video-title {
            color: var(--secondary);
            font-size: 2rem;
            font-weight: 900;
        }
        
        .close-video {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            border: none;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 2rem;
            transition: all 0.3s ease;
            z-index: 10001;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        
        .close-video:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(206, 17, 38, 0.4);
        }
        
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
            border-radius: 12px;
            border: 3px solid var(--accent);
        }
        
        .video-wrapper video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  MOBILE RESPONSIVE CSS                                          */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        /* Mobile - Small Phones (up to 480px) */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  BOTTOM NAVIGATION (Mobile Only)                              */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        .bottom-nav {
            display: none; /* Hidden on desktop */
        }
        
        @media only screen and (max-width: 767px) {
            /* ğŸ“± Mobile: hide floating buttons (use bottom nav instead) */
            .floating-buttons,
            .floating-btn,
            .floating-btn-chat,
            .floating-btn-ai{
                display: none !important;
                pointer-events: none !important;
            }

            .bottom-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(10, 15, 26, 0.98);
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                display: flex;
                justify-content: space-around;
                align-items: center;
                padding: 0.5rem 0;
                z-index: 1000;
                box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
            }
            
            .bottom-nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 0.25rem;
                padding: 0.5rem 1rem;
                background: none;
                border: none;
                color: rgba(255, 255, 255, 0.6);
                text-decoration: none;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 70px;
            }
            
            .bottom-nav-item i {
                font-size: 1.25rem;
            }

            /* ğŸ­ Bottom Nav: Zaina AI avatar icon */
            .nav-avatar{
                width: 33px;
                height: 33px;
                border-radius: 999px;
                object-fit: cover;
                border: 2px solid rgba(34,197,94,.9);
                box-shadow: 0 0 10px rgba(34,197,94,.35);
                display: block;
                margin: 0 auto 6px;
            }
            
            .bottom-nav-item span {
                font-size: 0.7rem;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .bottom-nav-item.active,
            .bottom-nav-item:active {
                color: var(--neon-green);
            }
            
            .bottom-nav-item:hover {
                color: var(--primary);
            }
            
            /* Add padding to body to account for bottom nav */
            body {
                padding-bottom: 70px !important;
            }
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        /*  MOBILE PHONES - CONSOLIDATED (0-767px)                        */
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media only screen and (max-width: 767px) {
            /* CRITICAL: Everything must fit and be visible */
            * {
                box-sizing: border-box;
            }
            
            html {
                overflow-x: hidden;
                overflow-y: auto;
                height: 100%;
                width: 100vw;
            }
            
            body {
                overflow-x: hidden !important;
                overflow-y: auto !important;
                height: auto !important;
                min-height: 100vh;
                margin: 0;
                padding: 0;
                padding-bottom: 80px; /* Space for floating buttons */
                width: 100%;
                max-width: 100vw;
            }
            
            /* Ensure all containers don't exceed viewport width */
            .header,
            .hero-banner,
            .category-nav-section,
            .content-container,
            .category-section {
                width: 100%;
                max-width: 100vw;
                overflow-x: hidden;
            }
            
            /* Header - Clean like Hulu */
            .header {
                padding: 0.75rem 1rem;
                position: sticky;
                top: 0;
                z-index: 100;
                background: rgba(10, 15, 26, 0.98);
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
            }
            
            .header-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
                max-width: 100%;
                margin: 0;
                padding: 0;
                gap: 0.75rem;
            }
            
            .logo-container {
                gap: 0.5rem;
                flex-shrink: 0;
            }
            
            .logo-container img {
                height: 32px;
                width: auto;
            }
            
            .logo-text {
                font-size: 1.2rem;
                white-space: nowrap;
                font-weight: 900;
            }
            
            /* Hide desktop nav */
            .header-nav {
                display: none !important;
            }
            
            /* Right side actions - icon buttons only */
            /* Header - allow horizontal scroll */
            .header {
                padding: 0.75rem 0.5rem !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                -webkit-overflow-scrolling: touch !important;
            }
            
            .header-content {
                flex-wrap: nowrap !important;
                min-width: min-content !important;
            }
            
            .nav-actions {
                display: flex;
                gap: 0.5rem;
                flex-wrap: nowrap;
                flex-shrink: 0;
                align-items: center;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                -webkit-overflow-scrolling: touch !important;
                scrollbar-width: none !important;
                -ms-overflow-style: none !important;
            }
            
            /* Hide scrollbar but keep scroll */
            .nav-actions::-webkit-scrollbar {
                display: none !important;
            }
            
            /* Icon buttons - bigger and easier to tap */
            .btn-icon {
                width: 40px !important;
                height: 40px !important;
                min-width: 40px !important;
                padding: 0 !important;
                font-size: 1rem !important;
                flex-shrink: 0;
                border-width: 2px !important;
                background: rgba(34, 197, 94, 0.1) !important;
            }
            
            /* Hide "Sign In" text on mobile, show icon only */
            .btn-primary {
                width: 40px !important;
                height: 40px !important;
                padding: 0 !important;
                border-radius: 50% !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                min-width: 40px !important;
            }
            
            .btn-primary span {
                display: none !important;
            }
            
            /* Add icon to sign in button */
            .btn-primary::before {
                content: 'ğŸ‘¤';
                font-size: 1.2rem;
            }
            
            .btn-icon-text span {
                display: none !important;
            }
            
            .btn-primary {
                width: 32px !important;
                height: 32px !important;
                padding: 0 !important;
                font-size: 0.85rem !important;
            }
            
            .btn-primary span {
                display: none !important;
            }
            
            /* Jellyfin Viewer Overlay - Mobile Fix */
            .viewer-header {
                padding: 0.5rem !important;
                gap: 0.5rem !important;
                min-height: 50px !important;
                max-height: 50px !important;
                flex-wrap: nowrap !important;
            }
            
            .viewer-logo {
                gap: 0.25rem !important;
            }
            
            .viewer-logo img {
                height: 16px !important; /* TINY logo! */
            }
            
            .viewer-logo span {
                font-size: 0.6rem !important; /* TINY text! */
                font-weight: 700 !important;
            }
            
            .viewer-back {
                padding: 0.75rem 1rem !important; /* Bigger touch area! */
                font-size: 1rem !important;
                white-space: nowrap !important;
                flex-shrink: 0 !important;
                min-width: 44px !important; /* Apple's minimum touch target */
                min-height: 44px !important;
            }
            
            .viewer-back i {
                font-size: 1rem !important;
            }
            
            .viewer-controls {
                gap: 0.5rem !important;
            }
            
            .viewer-controls .btn-icon {
                width: 36px !important;
                height: 36px !important;
                min-width: 36px !important;
                padding: 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }
            
            .viewer-controls .btn-icon i {
                font-size: 1rem !important;
                margin: 0 !important;
            }
            
            .viewer-close {
                width: 36px !important;
                height: 36px !important;
                min-width: 36px !important;
                padding: 0 !important;
                font-size: 1.2rem !important;
            }
            
            /* Hero Banner - Fits nicely */
            .hero-banner {
                min-height: 300px !important;
                max-height: 400px !important;
                height: auto !important;
                padding: 1rem !important;
                margin-bottom: 1rem !important;
                width: 100%;
                overflow: hidden;
            }
            
            .hero-title {
                font-size: 1.4rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .hero-description {
                font-size: 0.85rem !important;
                margin-bottom: 0.75rem !important;
                display: -webkit-box;
                -webkit-line-clamp: 3;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            .cta-buttons {
                display: flex;
                gap: 0.5rem !important;
                flex-wrap: wrap;
            }
            
            .btn-primary, 
            .btn-secondary {
                padding: 0.6rem 1.2rem !important;
                font-size: 0.9rem !important;
            }
            
            /* Category Navigation - Horizontal scroll like Hulu */
            .category-nav-section {
                padding: 1rem !important;
                margin-bottom: 0.5rem !important;
                width: 100%;
                overflow: hidden;
                background: rgba(26, 31, 46, 0.5);
            }
            
            .category-nav-title {
                font-size: 1rem !important;
                padding: 0 !important;
                margin-bottom: 0.75rem !important;
                font-weight: 700 !important;
                letter-spacing: 0.5px;
            }
            
            .category-nav-wrapper {
                position: relative;
                width: 100%;
                overflow: hidden;
            }
            
            .category-nav-arrow {
                display: none !important;
            }
            
            .category-nav-scroll {
                display: flex;
                gap: 0.5rem !important;
                padding: 0 !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
                scrollbar-width: none;
            }
            
            .category-nav-scroll::-webkit-scrollbar {
                display: none;
            }
            
            /* Category cards - smaller, pill-shaped */
            .category-nav-item {
                flex: 0 0 160px !important;
                min-width: 160px !important;
                height: 90px !important;
                border-radius: 12px !important;
            }
            
            .category-nav-name {
                font-size: 0.85rem !important;
                font-weight: 700 !important;
            }
            
            /* Live Channel Card */
            .live-channel-card {
                flex: 0 0 160px !important;
                height: 100px !important;
                min-width: 160px !important;
                scroll-snap-align: start;
            }
            
            /* Red bar at bottom - much smaller on mobile! */
            .live-channel-content {
                height: 35px !important;
                padding: 0.4rem 0.6rem !important;
            }
            
            .live-indicator {
                font-size: 0.65rem !important;
                margin-bottom: 0.15rem !important;
                gap: 4px !important;
            }
            
            .live-dot {
                width: 6px !important;
                height: 6px !important;
            }
            
            .live-channel-name {
                font-size: 0.7rem !important;
                line-height: 1 !important;
            }
            
            /* Category Cards */
            .category-card {
                flex: 0 0 120px !important;
                height: 75px !important;
                min-width: 120px !important;
                scroll-snap-align: start;
            }
            
            .category-name {
                font-size: 0.8rem !important;
            }
            
            /* COLLECTIONS - Netflix Style */
            .collection-section {
                margin-bottom: 1.5rem !important;
                padding: 0 !important;
                width: 100%;
            }
            
            .collection-header {
                padding: 0 0.75rem !important;
                margin-bottom: 0.75rem !important;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .collection-header h2 {
                font-size: 1.1rem !important;
                font-weight: 700 !important;
                margin: 0 !important;
            }
            
            .view-all-btn {
                font-size: 0.85rem !important;
                padding: 0.3rem 0.6rem !important;
            }
            
            /* MOVIE CARDS - Horizontal Scroll (Tubi size!) */
            .movies-scroll {
                display: flex !important;
                gap: 0.4rem !important;
                padding: 0 0.75rem !important;
                overflow-x: auto !important;
                overflow-y: hidden !important;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x proximity;
                scrollbar-width: none;
            }
            
            .movies-scroll::-webkit-scrollbar {
                display: none;
            }
            
            /* Header - Much smaller on Mobile */
            header {
                padding: 0.5rem !important;
                min-height: 50px !important;
            }
            
            .logo-container {
                gap: 0.25rem !important;
            }
            
            .logo-container img {
                height: 30px !important;
            }
            
            .logo-text {
                font-size: 1rem !important; /* Much smaller! */
                font-weight: 700 !important;
            }
            
            /* Bottom Navigation - Smaller */
            .bottom-nav {
                height: 60px !important;
                padding: 0.5rem 0 !important;
            }
            
            .bottom-nav button {
                font-size: 0.7rem !important;
                gap: 0.25rem !important;
            }
            
            /* MOVIE CARDS - Portrait/vertical for better movie poster visibility */
            .content-carousel {
                display: grid !important;
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 0.5rem !important;
                padding: 0.5rem !important;
                overflow-x: visible !important;
            }
            
            .movie-card,
            .content-card {
                flex: none !important;
                min-width: 100% !important;
                max-width: 100% !important;
                width: 100% !important;
                scroll-snap-align: none;
                margin-bottom: 0;
                position: relative !important;
            }
            
            /* HIDE ALL TEXT on mobile - just show poster images! */
            .content-card-overlay,
            .movie-info,
            .movie-title,
            .content-card-title,
            .movie-year,
            .movie-rating,
            .content-card-info {
                display: none !important;
            }
            
            /* MOVIE POSTERS - VERTICAL/PORTRAIT like real movie posters! */
            .movie-poster,
            .content-card-image {
                width: 100% !important;
                height: auto !important;
                aspect-ratio: 2 / 3 !important; /* PORTRAIT - taller than wide! */
                border-radius: 6px !important;
                object-fit: cover;
                max-height: 180px !important;
            }
            
            /* CATEGORY CARDS - Keep landscape/horizontal */
            .category-nav-item,
            .live-channel-card {
                aspect-ratio: 16 / 9 !important; /* Stay landscape */
            }
            
            /* Collection Headers - Smaller */
            .collection-header h2 {
                font-size: 0.9rem !important; /* Much smaller! */
                margin: 0 !important;
                font-weight: 700 !important;
            }
            
            .collection-section {
                margin-bottom: 1rem !important;
            }
            
            .view-all-btn {
                font-size: 0.7rem !important;
                padding: 0.25rem 0.5rem !important;
            }
            
            .movie-year {
                font-size: 0.6rem !important;
            }
            
            .movie-info {
                padding: 0.4rem 0.2rem !important;
            }
            
            .movie-title {
                font-size: 0.7rem !important;
                line-height: 1.1 !important;
                margin-bottom: 0.2rem !important;
                font-weight: 600 !important;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            .movie-year,
            .movie-rating {
                font-size: 0.65rem !important;
            }
            
            /* Grid Views (if used) */
            .movies-grid,
            .content-grid {
                display: grid !important;
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 0.75rem !important;
                padding: 0 0.75rem !important;
            }
            
            .movies-grid .movie-card,
            .content-grid .movie-card {
                flex: none !important;
                min-width: 100% !important;
                max-width: 100% !important;
            }
            
            /* Video Modal - Full Screen */
            .video-modal {
                padding: 0 !important;
            }
            
            .video-container {
                width: 100% !important;
                height: 100vh !important;
                border-radius: 0 !important;
            }
            
            .close-video {
                width: 44px !important;
                height: 44px !important;
                font-size: 1.8rem !important;
                top: 10px !important;
                right: 10px !important;
            }
            
            /* Side Panels */
            .side-panel {
                width: 90% !important;
                max-width: 100% !important;
                height: 100vh !important;
            }
            
            /* Panel Header - MUCH THINNER on mobile */
            .panel-header {
                padding: 0.75rem !important;
                min-height: 50px !important;
            }
            
            .panel-title {
                font-size: 1rem !important;
                font-weight: 700 !important;
            }
            
            .panel-close,
            .panel-toggle {
                width: 36px !important;
                height: 36px !important;
                font-size: 1rem !important;
            }
            
            /* Chat Input Area - Mobile Fix */
            .chat-input-area {
                padding: 0.75rem !important;
                gap: 0.5rem !important;
                position: sticky !important;
                bottom: 0 !important;
                background: #282828 !important;
                z-index: 100 !important;
            }
            
            .chat-input,
            #aiChatInput {
                font-size: 16px !important; /* Prevents iOS zoom */
                min-height: 44px !important;
                padding: 0.75rem !important;
                width: 100% !important;
            }
            
            .chat-btn,
            .panel-body button {
                min-width: 44px !important;
                min-height: 44px !important;
                touch-action: manipulation !important;
                -webkit-tap-highlight-color: rgba(34, 197, 94, 0.3) !important;
                cursor: pointer !important;
            }
            
            .chat-btn:active,
            #sendBtn:active {
                transform: scale(0.95) !important;
                background-color: var(--neon-green) !important;
            }
            
            /* AI Panel Content */
            .panel-body {
                padding: 1rem !important;
                overflow-y: auto !important;
                -webkit-overflow-scrolling: touch !important;
            }
            
            /* AI Search button - smaller on mobile */
            #aiSearchButton {
                padding: 0.75rem !important;
                font-size: 1rem !important;
                min-width: 50px !important;
            }
            
            /* Hide search text on mobile, show only icon */
            #aiSearchButton .search-text {
                display: none !important;
            }
            
            .panel-body input[type="text"] {
                font-size: 16px !important; /* Prevents iOS zoom */
            }
            
            /* Floating Buttons */
            .floating-btn {
                width: 56px !important;
                height: 56px !important;
                font-size: 1.3rem !important;
            }
            
            .floating-btn-chat {
                bottom: 150px !important;
                right: 20px !important;
            }
            
            .floating-btn-ai {
                bottom: 80px !important;
                right: 20px !important;
            }
        }
        
        /* LANDSCAPE ORIENTATION - Phone turned sideways */
        @media (max-width: 968px) and (orientation: landscape) {
            /* Use more columns when phone is sideways */
            .content-carousel {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 0.4rem !important;
            }
            
            .movie-poster,
            .content-card-image {
                max-height: 100px !important;
            }
            
            /* Smaller header in landscape */
            header {
                padding: 0.25rem 0.5rem !important;
                min-height: 45px !important;
            }
            
            /* Bottom nav smaller in landscape */
            .bottom-nav {
                height: 50px !important;
            }
            
            /* Floating buttons smaller */
            .floating-btn {
                width: 48px !important;
                height: 48px !important;
            }
            
            .floating-btn-chat {
                bottom: 100px !important;
            }
            
            .floating-btn-ai {
                bottom: 50px !important;
            }
        }
        
            .side-panel {
                width: 100%;
                right: -100%;
            }
            
            .side-panel.active {
                right: 0;
            }
            
            .section-title {
                font-size: 1.3rem !important;
            }
        }
        
        /* Mobile - Regular Phones (481px to 767px) */
        @media (min-width: 481px) and (max-width: 767px) {
            .header-nav {
                gap: 0.5rem !important;
            }
            
            .header-nav a {
                font-size: 0.75rem !important;
                padding: 0.25rem 0.5rem !important;
            }
            
            /* Sign In button - MUCH smaller on mobile */
            .btn-primary {
                font-size: 0.75rem !important;
                padding: 0.4rem 0.75rem !important;
                white-space: nowrap !important;
            }
            
            /* Show only icon on mobile for Sign In */
            #signInBtn {
                background: none !important;
                border: 1px solid var(--neon-green) !important;
                padding: 0.5rem !important;
                font-size: 1rem !important;
                min-width: 40px !important;
                width: 40px !important;
                height: 40px !important;
                border-radius: 50% !important;
            }
            
            /* Hide the text, show only icon */
            #signInBtn i {
                margin: 0 !important;
            }
            
            #signInBtn .sign-in-text {
                display: none !important;
            }
            
            /* Header navigation buttons - good size with scroll function */
            .btn-icon-text {
                padding: 0.5rem 0.9rem !important;
                font-size: 0.8rem !important;
                gap: 0.4rem !important;
                border-width: 2px !important;
            }
            
            .btn-icon-text i {
                font-size: 0.9rem !important;
            }
            
            .btn-icon {
                padding: 0.5rem !important;
                width: 40px !important;
                height: 40px !important;
                font-size: 1rem !important;
                border-width: 2px !important;
            }
            
            /* Header buttons container - scrollable! */
            .header-nav {
                flex-wrap: nowrap !important;
                overflow-x: visible !important;
            }
            
            .logo-text {
                font-size: 0.9rem !important; /* MUCH smaller for mobile! */
            }
            
            .hero-title {
                font-size: 1.8rem !important;
            }
            
            .live-channel-card {
                flex: 0 0 280px;
                max-width: 280px;
            }
            
            .category-card {
                flex: 0 0 180px;
                height: 100px;
            }
            
            .movies-grid, .content-grid {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 1rem !important;
            }
            
            .side-panel {
                width: 90%;
                right: -90%;
            }
            
            .side-panel.active {
                right: 0;
            }
        }
        
        /* Tablets (768px to 1024px) */
        @media (min-width: 768px) and (max-width: 1024px) {
            .header-nav {
                gap: 1rem;
            }
            
            .live-channel-card {
                flex: 0 0 300px;
            }
            
            .category-card {
                flex: 0 0 200px;
            }
            
            .movies-grid, .content-grid {
                grid-template-columns: repeat(4, 1fr) !important;
            }
            
            .side-panel {
                width: 400px;
            }
        }
        
        /* General mobile improvements */
        @media (max-width: 1024px) {
            body.panel-active {
                padding-right: 0 !important;
            }
            
            body {
                font-size: 16px;
            }
            
            input, textarea {
                font-size: 16px !important;
            }
            
            button, a {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Category navigation arrows bigger on mobile */
            .category-nav-arrow {
                width: 40px;
                height: 40px;
            }
            
            /* Make horizontal scrolling smoother */
            .category-nav-scroll,
            .movie-row-scroll {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }
        }
        
        /* Landscape mode on phones */
        @media (max-width: 767px) and (orientation: landscape) {
            .hero-banner {
                min-height: auto !important;
                padding: 2rem 1rem !important;
            }
            
            .video-modal {
                padding: 0;
            }
            
            .video-container {
                width: 100%;
                height: 100vh;
            }
            
            .header-nav {
                display: flex !important;
                gap: 0.5rem;
            }
            
            .header-nav a {
                font-size: 0.85rem;
            }
        }
        
        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .live-dot {
                animation: none !important;
            }
            
            .category-nav-scroll,
            .movie-row-scroll {
                scroll-behavior: auto !important;
            }
        }
        
    </style>
</head>
<body>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  HEADER                                                         -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <header class="header">
        <div class="header-content">
            <!-- LEFT SIDE: Logo + Text Nav -->
            <div style="display: flex; align-items: center; gap: 1.5rem; flex-shrink: 0;">
                <div class="logo-container">
                    <img src="assets/logos/flm-logo.png" alt="FLM TV Logo">
                    <h1 class="logo-text">FLM TV</h1>
                </div>
                
                <nav>
                    <ul class="header-nav">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="#" onclick="scrollToCollection('6fcfa6221b9a5741d5fdcf30f78f946b'); return false;">Movies</a></li>
                        <li><a href="#" onclick="scrollToCollection('7e2a5d7fd8bd73b8768e302be39536df'); return false;">TV Shows</a></li>
                        <li><a href="#" onclick="openLiveStream(); return false;">ğŸ”´ Live TV</a></li>
                        <li><a href="#" onclick="scrollToCategoryNav(); return false;">Categories</a></li>
                    </ul>
                </nav>
            </div>
            
            <!-- RIGHT SIDE: Scrollable Buttons -->
            <div class="nav-actions">
                <!-- Back to Gate Button -->
                <button class="btn-icon" onclick="window.location.href='index.html'" title="Back to Home" style="border-color: var(--accent); color: var(--accent);">
                    <i class="fas fa-home"></i>
                </button>
                
                <button class="btn-icon-text" onclick="openPanel('chatPanel')" title="Chat">
                    <i class="fas fa-comments"></i> Chat
                </button>
                
                <button class="btn-icon-text" onclick="openPanel('aiPanel')" title="Zaina AI">
                    <i class="fas fa-robot"></i> Zaina AI
                </button>
                
                <button class="btn-icon" title="Notifications">
                    <i class="fas fa-bell"></i>
                </button>
                
                <button class="btn-icon" id="parentLockBtn" title="Parental Controls">
                    <i class="fas fa-lock"></i>
                </button>
                
                <button class="btn-primary" id="signInBtn">
                    <i class="fas fa-user"></i><span class="sign-in-text"> Sign In / Sign Up</span>
                </button>
            </div>
        </div>
    </header>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  HERO BANNER                                                    -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <section class="hero-banner" id="heroBanner">
        <!-- Slides will be dynamically inserted here -->
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  CATEGORY NAVIGATION                                            -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <section class="category-nav-section">
        <div class="category-nav-container">
            <h2 class="category-nav-title">Browse Categories</h2>
            <div class="category-nav-wrapper">
                <button class="category-nav-arrow left" onclick="scrollCategoryNav(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="category-nav-scroll" id="categoryNavScroll">
                    <!-- LIVE CHANNEL 26.5 - vMix Stream -->
                    <div class="live-channel-card" onclick="openLiveStream()">
                        <video id="previewVideo" muted autoplay loop playsinline
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; pointer-events: none;">
                            <source src="https://flmtv26.duckdns.org/hls/FLMTV.m3u8" type="application/x-mpegURL">
                        </video>
                        <div class="live-channel-content">
                            <div class="live-indicator">
                                <div class="live-dot"></div>
                                <span>ğŸ”´ LIVE</span>
                            </div>
                            <div class="live-channel-name">FLM Channel 26.5 Las Vegas</div>
                        </div>
                        <!-- Volume Toggle Button -->
                        <button id="volumeToggle" onclick="event.stopPropagation(); togglePreviewVolume()" 
                            style="position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); border: none; color: white; padding: 8px 12px; border-radius: 50%; cursor: pointer; z-index: 10; font-size: 1.2rem;">
                            <i class="fas fa-volume-mute"></i>
                        </button>
                    </div>
                    <!-- Category cards will be dynamically added here -->
                </div>
                <button class="category-nav-arrow right" onclick="scrollCategoryNav(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  CONTENT SECTIONS                                               -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="content-container" id="contentContainer">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">Loading your content...</div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  SIGN IN MODAL                                                  -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="modal-overlay" id="signInModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title" style="color: white;">Log In</h3>
                <button class="modal-close" onclick="closeModal('signInModal')" style="background: none; border: none; color: white; font-size: 2rem; cursor: pointer; line-height: 1;">
                    âœ•
                </button>
            </div>
            <div class="modal-body" style="padding: 2rem;">
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <input type="email" class="form-input" placeholder="Email Address" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: white; color: #333; font-size: 1rem;">
                </div>
                <div class="form-group" style="margin-bottom: 1rem; position: relative;">
                    <input type="password" id="signInPassword" class="form-input" placeholder="Password" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: #3a3a3a; color: white; font-size: 1rem;">
                    <button onclick="togglePassword('signInPassword')" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: #999; cursor: pointer; font-size: 1.2rem;">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <a href="#" style="color: #999; text-decoration: none; font-size: 0.9rem;">Forgot Password?</a>
                </div>
                <button class="btn-modal btn-modal-primary" style="width: 100%; padding: 1rem; background: var(--secondary); color: white; border: none; border-radius: 0.25rem; font-size: 1rem; font-weight: 600; cursor: pointer; margin-bottom: 1rem;">
                    Log In
                </button>
                <div style="text-align: center; margin-bottom: 1.5rem; color: #999;">
                    Not a member? <a href="#" style="color: var(--secondary); text-decoration: none; font-weight: 600;">Sign Up</a>
                </div>
                <button style="width: 100%; padding: 1rem; background: #666; color: white; border: none; border-radius: 0.25rem; font-size: 1rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                    ğŸ‘‘ Try Paid Membership
                </button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  PARENT LOCK MODAL                                              -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="modal-overlay" id="parentLockModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title" style="color: var(--secondary); font-weight: 700;">Set Parent Code</h3>
                <button class="modal-close" onclick="closeModal('parentLockModal')" style="background: none; border: none; color: white; font-size: 2rem; cursor: pointer; line-height: 1;">
                    âœ•
                </button>
            </div>
            <div class="modal-body" style="padding: 2rem;">
                <p style="color: var(--accent); text-align: center; margin-bottom: 2rem; font-size: 1.1rem;">
                    Please set a 4-digit parent code and a security question.
                </p>
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <input type="password" id="parentCode1" class="form-input" placeholder="Enter new 4-digit code" maxlength="4" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: #3a3a3a; color: white; font-size: 1rem;">
                </div>
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <input type="password" id="parentCode2" class="form-input" placeholder="Confirm 4-digit code" maxlength="4" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: #3a3a3a; color: white; font-size: 1rem;">
                </div>
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <input type="text" id="securityQuestion" class="form-input" placeholder="Enter a security question (e.g., Mother's maiden name?)" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: #3a3a3a; color: white; font-size: 1rem;">
                </div>
                <div class="form-group" style="margin-bottom: 2rem;">
                    <input type="password" id="securityAnswer" class="form-input" placeholder="Enter the answer" style="width: 100%; padding: 1rem; border-radius: 0.25rem; border: 1px solid #444; background: #3a3a3a; color: white; font-size: 1rem;">
                </div>
                <button class="btn-modal btn-modal-primary" style="width: 100%; padding: 1rem; background: var(--secondary); color: white; border: none; border-radius: 0.25rem; font-size: 1rem; font-weight: 700; cursor: pointer; margin-bottom: 1rem;">
                    Set Code
                </button>
                <div style="text-align: center;">
                    <a href="#" onclick="closeModal('parentLockModal'); return false;" style="color: #999; text-decoration: none;">Cancel</a>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  CHAT PANEL                                                     -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="side-panel" id="chatPanel">
        <div class="panel-header">
            <div>
                <h3 class="panel-title" style="margin-bottom: 0.25rem;"><i class="fas fa-comments"></i> Live Chat</h3>
                <p style="font-size: 0.75rem; color: #b3b3b3; margin: 0;">Chat with viewers worldwide ğŸŒ</p>
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <button class="panel-toggle" onclick="togglePanelFullscreen('chatPanel')" title="Expand Panel">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="panel-close" onclick="closePanel('chatPanel')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        
        <!-- Simple Username Input -->
        <div style="padding: 0.75rem; background: #282828; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 0.5rem;">
            <label style="font-size: 0.85rem; color: #b3b3b3; white-space: nowrap;">Name:</label>
            <input type="text" id="chatUsernameInput" placeholder="Enter your name" 
                   style="flex: 1; padding: 0.5rem; background: #1a1a1a; border: 1px solid #444; border-radius: 6px; color: white; font-size: 0.9rem;"
                   maxlength="20">
        </div>
        
        <div class="chat-messages" id="chatMessages" style="flex-grow: 1; padding: 1rem; overflow-y: auto; background-color: #1a1a1a;">
        </div>
        
        <div class="chat-input-area" style="background-color: #282828; padding: 1rem; border-top: 1px solid #333; display: flex; align-items: center; gap: 0.5rem; position: sticky; bottom: 0; flex-shrink: 0;">
            <textarea id="chatInput" class="chat-input" placeholder="Type your message..." style="flex-grow: 1; padding: 0.75rem; border-radius: 1.5rem; border: 1px solid #444; background-color: #333; color: white; outline: none; font-size: 1em; resize: none; min-height: 40px; max-height: 100px; overflow-y: auto; font-family: inherit;"></textarea>
            <button id="emojiBtn" class="chat-btn" style="background-color: var(--secondary); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.2em; flex-shrink: 0;">ğŸ˜€</button>
            <button id="sendBtn" class="chat-btn" style="background-color: var(--secondary); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.2em; flex-shrink: 0;">
                <i class="fas fa-paper-plane"></i>
            </button>
            <div id="emojiPicker" class="emoji-picker" style="position: absolute; bottom: calc(100% + 10px); left: 0; right: 0; background-color: #282828; border-radius: 8px; box-shadow: 0 -5px 15px rgba(0,0,0,0.4); padding: 1rem; display: none; flex-wrap: wrap; gap: 0.5rem; max-height: 200px; overflow-y: auto; z-index: 10;"></div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  ZAINA AI PANEL                                                 -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="side-panel" id="aiPanel">
        <div class="panel-header">
            <h3 class="panel-title"><i class="fas fa-robot"></i> Zaina J AI</h3>
            <div style="display: flex; gap: 0.5rem;">
                <button class="panel-toggle" onclick="togglePanelFullscreen('aiPanel')" title="Expand Panel">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="panel-close" onclick="closePanel('aiPanel')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="panel-body" style="padding: 1.5rem; overflow-y: auto; flex-grow: 1;">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                <img src="assets/images/z-ai-avatar2.png" alt="Zaina AI" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent);">
                <div>
                    <h4 style="color: var(--accent); font-weight: 700; margin-bottom: 0.25rem;">Zaina J AI</h4>
                    <p style="color: var(--text-secondary); font-size: 0.875rem;">Your Entertainment Assistant</p>
                </div>
            </div>
            
            <!-- ZAINA AI Assistant Search (EXACT from working admin dashboard) -->
            <div style="background: rgba(255, 215, 0, 0.05); border: 2px solid var(--accent); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Search YouTube for trailers, auto-fill metadata, and preview posters.
                </p>
                <label style="color: var(--text); font-weight: 600; margin-bottom: 0.5rem; display: block;">
                    ğŸ¬ Search Film or Trailer:
                </label>
                <input id="lumaSearch" placeholder="Enter film title..." 
                       onkeypress="if(event.key === 'Enter') searchYouTube()"
                       style="width: 100%; padding: 0.75rem; border-radius: 0.5rem; background: rgba(0,0,0,0.3); color: white; border: 2px solid rgba(255, 215, 0, 0.3); font-family: inherit; margin-bottom: 1rem;">
                <button onclick="searchYouTube()" 
                        style="width: 100%; background: var(--accent); color: #000; padding: 0.75rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 700; font-size: 1rem;">
                    ğŸ” Search YouTube
                </button>
                <div id="lumaResults" style="margin-top: 1.5rem;"></div>
            </div>
            
            <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: var(--text);">
                Search film info, trailers, actors...
            </h3>
            <div style="display: flex; gap: 0.5rem; margin-bottom: 2rem;">
                <input type="text" id="aiSearchInput" placeholder="Search film..." 
                       style="flex: 1; padding: 0.75rem; border-radius: 0.5rem; background: #333; color: white; border: 1px solid #444; font-family: inherit;">
                <button id="aiSearchButton" 
                        style="background: var(--secondary); color: white; padding: 0.75rem 1.25rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600;">
                    <i class="fas fa-search"></i><span class="search-text"> Search</span>
                </button>
            </div>
            
            <!-- AI Chat Messages Area -->
            <div style="border-top: 1px solid #333; padding-top: 1.5rem; margin-top: 1.5rem;">
                <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--neon-green);">
                    Chat with Zaina AI
                </h3>
                <div id="aiMessages" class="chat-messages" style="background-color: #1a1a1a; border-radius: 8px; padding: 1rem; min-height: 200px; max-height: 300px; overflow-y: auto; margin-bottom: 1rem;">
                    <div class="message received">
                        <div class="message-bubble">ğŸ‘‹ Hi! I'm Zaina AI. Ask me anything about movies, TV shows, or entertainment!</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Chat Input Area -->
        <div class="chat-input-area" style="background-color: #282828; padding: 1rem; border-top: 1px solid #333; display: flex; align-items: center; gap: 0.5rem;">
            <textarea id="aiChatInput" class="chat-input" placeholder="Ask Zaina AI anything..." style="flex-grow: 1; padding: 0.75rem; border-radius: 1.5rem; border: 1px solid #444; background-color: #333; color: white; outline: none; font-size: 1em; resize: none; min-height: 40px; max-height: 100px; overflow-y: auto; font-family: inherit;"></textarea>
            <button id="aiSendBtn" class="chat-btn" style="background-color: var(--accent); color: #000; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.2em; flex-shrink: 0;">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  FLOATING BUTTONS                                               -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <!-- Jellyfin Viewer Frame (FLM Branded) -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  LIVE VIDEO PLAYER MODAL                                        -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <div class="video-modal" id="videoModal">
        <div class="video-container">
            <!-- Close Button with visible X -->
            <button class="close-video" onclick="closeLiveStream()" title="Close">
                <span style="font-size: 2rem; line-height: 1;">Ã—</span>
            </button>
            
            <!-- Back Button -->
            <button class="back-from-video" onclick="closeLiveStream()" title="Back to Home">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            
            <video id="liveStreamVideo" controls autoplay 
                width="100%" 
                height="100%"
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000;">
                <source src="https://flmtv26.duckdns.org/hls/FLMTV.m3u8" type="application/x-mpegURL">
                Your browser does not support HLS playback.
            </video>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  LIVE TV CHANNEL 26.5                                           -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    
    </div>

    <div class="jellyfin-viewer" id="jellyfinViewer">
        <div class="viewer-header">
            <div class="viewer-logo">
                <img src="assets/logos/flm-logo.png" alt="FLM TV" onerror="this.style.display='none'">
                <span>FLM TV</span>
                <a href="https://7realmstv.com" target="_blank" style="margin-left: 1rem; color: #fcd116; text-decoration: none; font-size: 0.9rem; opacity: 0.8; transition: opacity 0.2s;" title="Visit 7RealmsTV">
                    <i class="fas fa-globe"></i> 7RealmsTV
                </a>
            </div>
            
            <button class="viewer-back" onclick="closeViewer()">
                <i class="fas fa-arrow-left"></i> Back to Browse
            </button>
            
            <div class="viewer-controls">
                <!-- Chat & AI Buttons -->
                <button class="btn-icon" onclick="openPanel('chatPanel')" title="Chat">
                    <i class="fas fa-comments"></i>
                </button>
                <button class="btn-icon" onclick="openPanel('aiPanel')" title="Zaina AI">
                    <i class="fas fa-robot"></i>
                </button>
                
                <!-- Close Button -->
                <button class="viewer-close" onclick="closeViewer()" title="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <iframe id="jellyfinFrame" src="" allow="autoplay; encrypted-media; fullscreen" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
    </div>
    
    <!-- Floating Chat/AI buttons for main page -->
    <div class="floating-buttons">
        <button class="floating-btn floating-btn-chat" onclick="openPanel('chatPanel')" title="Chat">
            <i class="fas fa-comments"></i>
        </button>
        <button class="floating-btn floating-btn-ai" onclick="openPanel('aiPanel')">
            <img src="assets/images/z-ai-avatar2.png" alt="Zaina AI">
        </button>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  HLS.JS FOR LIVE STREAMING                                      -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  FIREBASE & JAVASCRIPT                                          -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- Load API configuration from separate file -->
    <script src="private/config.js"></script>
    
    <script>
        console.log('ğŸ¬ FLM TV - Initializing...');
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  JELLYFIN CONFIGURATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
      const JELLYFIN_CONFIG = {
    SERVER: 'https://flmtv26.duckdns.org:8920',
    API_KEY: '62131ee22c0141c6b651be75a7444350',
    USER_ID: '0407d4609a0346f99c09e0d7ddc9ccd1',
    
    COLLECTIONS: [
        { id: 'ccb90a40ec8a4a2826f97a082fc18509', name: '00 Collections', url: 'https://flmtv26.duckdns.org:8920/web/index.html#!/list?parentId=ccb90a40ec8a4a2826f97a082fc18509&serverId=db6bb6388c8c4c70825698639853ede6' },
        { id: 'adf5c3d30aa8572dcb64577f4ae6b105', name: '01 MOVIES 1', url: 'https://flmtv26.duckdns.org:8920/web/#/movies?topParentId=adf5c3d30aa8572dcb64577f4ae6b105&collectionType=movies' },
        { id: '6fcfa6221b9a5741d5fdcf30f78f946b', name: '02 MOVIES 2', url: 'https://flmtv26.duckdns.org:8920/web/#/movies?topParentId=6fcfa6221b9a5741d5fdcf30f78f946b&collectionType=movies' },
        { id: '7e2a5d7fd8bd73b8768e302be39536df', name: '03 AWESOME TV & FILMS', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=7e2a5d7fd8bd73b8768e302be39536df&collectionType=tvshows' },
        { id: '5ff2dc76882e099b56c555f868f29abe', name: '04 ASIAN CINEMA', url: 'https://flmtv26.duckdns.org:8920/web/#/movies?topParentId=5ff2dc76882e099b56c555f868f29abe&collectionType=movies' },
        { id: 'ede598bcd27f80ea256af569dc7ac4a6', name: '05 CLASSIC TV', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=ede598bcd27f80ea256af569dc7ac4a6&collectionType=tvshows' },
        { id: 'ca43f3291c81d4f007f2b33936d256e6', name: '06 KIDS WORLD', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=ca43f3291c81d4f007f2b33936d256e6&collectionType=tvshows' },
        { id: 'a2347f687b9669054c8d2abbfd50889f', name: '07 GOLDEN CLASSICS', url: 'https://flmtv26.duckdns.org:8920/web/#/movies?topParentId=a2347f687b9669054c8d2abbfd50889f&collectionType=movies' },
        { id: 'eaddf6d7a354f68f5f1c6ff947baf506', name: '08 FILIPINA-tv â˜€ï¸', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=eaddf6d7a354f68f5f1c6ff947baf506&collectionType=tvshows' },
        { id: '9eb72a50280cf3ef5599f4c43a383611', name: '08-B TAGALOG â˜€ï¸', url: 'https://flmtv26.duckdns.org:8920/web/#/movies?topParentId=9eb72a50280cf3ef5599f4c43a383611&collectionType=movies' },
        { id: 'c71a54b70069a28e508358fa66e2a286', name: '09 INTERNATIONAL Films', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=c71a54b70069a28e508358fa66e2a286&collectionType=tvshows' },
        { id: '48d96f519acf2fce600d06a4365632f4', name: '10 FLM NEWS FILIPINA', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=48d96f519acf2fce600d06a4365632f4&collectionType=tvshows' },
        { id: 'f412dea8334c1260f2bfd6cfa91dddf5', name: '11 ASIAN Animation', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=f412dea8334c1260f2bfd6cfa91dddf5&collectionType=tvshows' },
        { id: '5f2f2ace0732efb63f625d1346b9c766', name: '12 ZAINA ZONE', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=5f2f2ace0732efb63f625d1346b9c766&collectionType=tvshows' },
        { id: '5ed2753fb759a28245f2a4cb6dc2f4fd', name: '13 COMEDY', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=5ed2753fb759a28245f2a4cb6dc2f4fd&collectionType=tvshows' },
        { id: '56f8dc1075207592d3248a09358c587a', name: '14 DOCUMENTARIES', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=56f8dc1075207592d3248a09358c587a&collectionType=tvshows' },
        { id: '7a941a433e06ec0512b64b1d3b52c782', name: '15 MIDNIGHT CIRCUIT', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=7a941a433e06ec0512b64b1d3b52c782&collectionType=tvshows' },
        { id: 'c95ec3ddc1e8cf075ba24840d92ad9bd', name: 'BEYOND REALITY', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=c95ec3ddc1e8cf075ba24840d92ad9bd&collectionType=tvshows' },
        { id: '4e985111ed7f570b595204d82adb02f3', name: 'Books', url: 'https://flmtv26.duckdns.org:8920/web/#/list?parentId=4e985111ed7f570b595204d82adb02f3&serverId=db6bb6388c8c4c70825698639853ede6' },
        { id: '8e596d67e544894b4502eba9aeb49b01', name: 'ESCAPE', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=8e596d67e544894b4502eba9aeb49b01&collectionType=tvshows' },
        { id: '12dc1447c71e042cf48154d67538804e', name: 'GAMING Coming Soon', url: 'https://flmtv26.duckdns.org:8920/web/#/tv?topParentId=12dc1447c71e042cf48154d67538804e&collectionType=tvshows' },
        { id: '2627e7d2c827d9bd908128d0320a8263', name: 'MUSIC', url: 'https://flmtv26.duckdns.org:8920/web/#/music?topParentId=2627e7d2c827d9bd908128d0320a8263&collectionType=music' },
        { id: 'e2c00f297a5f80af390f52f72e782147', name: 'Music Videos', url: 'https://flmtv26.duckdns.org:8920/web/#/list?parentId=e2c00f297a5f80af390f52f72e782147&serverId=db6bb6388c8c4c70825698639853ede6' },
    ]
};
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  FIREBASE & API CONFIGURATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyD871FYC8vGc7JAAw-2rGMZBB_h4sI0HpQ",
            authDomain: "flmtv-site-counter.firebaseapp.com",
            databaseURL: "https://flmtv-site-counter-default-rtdb.firebaseio.com",
            projectId: "flmtv-site-counter",
            storageBucket: "flmtv-site-counter.firebasestorage.app",
            messagingSenderId: "354930172302",
            appId: "1:354930172302:web:3176dfff3d81ce823404df"
        };
        
        // API keys are loaded from config.js
        // DO NOT put API keys directly in this file!
        
        // Initialize Firebase
        firebase.initializeApp(FIREBASE_CONFIG);
        const auth = firebase.auth();
        const database = firebase.database();
        
        // Sign in anonymously and wait for it
        let isAuthReady = false;
        let fallbackUserId = 'user_' + Math.random().toString(36).substring(7);
        
        auth.signInAnonymously()
            .then(() => {
                console.log('âœ… Firebase Auth: Signed in anonymously');
                isAuthReady = true;
            })
            .catch(err => {
                console.error('âŒ Firebase Auth Error:', err);
                console.log('âš ï¸ Using fallback mode - messages will still work!');
                // Don't show alert - just use fallback
                isAuthReady = true; // Allow chat to work with fallback
            });
        
        // Monitor auth state
        auth.onAuthStateChanged((user) => {
            if (user) {
                console.log('âœ… User authenticated:', user.uid.substring(0, 8));
                isAuthReady = true;
            } else {
                console.log('âš ï¸ Using fallback user ID');
                isAuthReady = true; // Allow fallback mode
            }
        });
        
        console.log('âœ… Firebase initialized!');
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  HELPER FUNCTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        
     async function jellyfinFetch(endpoint, params = {}) {
    const baseUrl = JELLYFIN_CONFIG.SERVER;
    
    if (!baseUrl.startsWith('http')) {
        const queryString = new URLSearchParams();
        queryString.append('api_key', JELLYFIN_CONFIG.API_KEY);
        
        Object.keys(params).forEach(key => {
            if (params[key] !== null && params[key] !== undefined) {
                queryString.append(key, params[key]);
            }
        });
        
        const url = `${baseUrl}${endpoint}?${queryString.toString()}`;
        
        console.log('ğŸ” Fetching:', url);
        
        try {
            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'Accept': 'application/json'
                }
            });
            
            if (!response.ok) {
                console.error('âŒ Jellyfin API Error:', response.status, response.statusText);
                return null;
            }
            const data = await response.json();
            console.log('âœ… Response:', data);
            return data;
        } catch (error) {
            console.error('âŒ Fetch Error:', error);
            return null;
        }
    }
    
    const url = new URL(`${baseUrl}${endpoint}`);
    url.searchParams.append('api_key', JELLYFIN_CONFIG.API_KEY);
    
    Object.keys(params).forEach(key => {
        if (params[key] !== null && params[key] !== undefined) {
            url.searchParams.append(key, params[key]);
        }
    });
    
    console.log('ğŸ” Fetching:', url.toString());
    
    try {
        const response = await fetch(url, {
            method: 'GET',
            mode: 'cors',
            credentials: 'omit',
            headers: {
                'Accept': 'application/json'
            }
        });
        
        if (!response.ok) {
            console.error('âŒ Jellyfin API Error:', response.status, response.statusText);
            return null;
        }
        const data = await response.json();
        console.log('âœ… Response:', data);
        return data;
    } catch (error) {
        console.error('âŒ Fetch Error:', error);
        return null;
    }
}
        
       function getImageUrl(itemId, imageTag, type = 'Primary') {
    return `${JELLYFIN_CONFIG.SERVER}/Items/${itemId}/Images/${type}?api_key=${JELLYFIN_CONFIG.API_KEY}&tag=${imageTag}&format=webp&maxHeight=450`;
}
        
        function scrollCategoryNav(direction) {
            const scroll = document.getElementById('categoryNavScroll');
            const scrollAmount = 300;
            scroll.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }
        
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // Scroll to a specific collection section
        function scrollToCollection(collectionId) {
            // Look for the section with this collection ID
            const section = document.querySelector(`[data-collection-id="${collectionId}"]`);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                console.log(`Collection section not found for ID: ${collectionId}`);
                // Fallback: scroll to content container
                const container = document.getElementById('contentContainer');
                if (container) {
                    container.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
        }
        
        // Scroll to the category navigation section
        function scrollToCategoryNav() {
            const categorySection = document.querySelector('.category-nav-section');
            if (categorySection) {
                categorySection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  BUILD CATEGORY NAVIGATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function buildCategoryNav() {
            const navScroll = document.getElementById('categoryNavScroll');
            
            console.log('ğŸ¨ Building category navigation...');
            
            for (const collection of JELLYFIN_CONFIG.COLLECTIONS) {
                try {
                    // Get collection info to determine type
                    const collectionInfo = await jellyfinFetch(`/Users/${JELLYFIN_CONFIG.USER_ID}/Items/${collection.id}`, {});
                    
                    // Get 5 random items to find one with a good backdrop
                    const items = await jellyfinFetch(`/Users/${JELLYFIN_CONFIG.USER_ID}/Items`, {
                        ParentId: collection.id,
                        Limit: 5,
                        SortBy: 'Random',
                        Recursive: true
                    });
                    
                    let backdropUrl = 'https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=300';
                    
                    if (items && items.Items && items.Items.length > 0) {
                        // Try to find item with backdrop, otherwise use primary image
                        let foundBackdrop = false;
                        
                        for (const item of items.Items) {
                            if (item.BackdropImageTags && item.BackdropImageTags.length > 0) {
                                backdropUrl = `${JELLYFIN_CONFIG.SERVER}/Items/${item.Id}/Images/Backdrop?api_key=${JELLYFIN_CONFIG.API_KEY}&tag=${item.BackdropImageTags[0]}&format=webp&maxWidth=300`;
                                foundBackdrop = true;
                                break;
                            }
                        }
                        
                        // If no backdrop found, use primary image from first item
                        if (!foundBackdrop && items.Items[0].ImageTags?.Primary) {
                            backdropUrl = getImageUrl(items.Items[0].Id, items.Items[0].ImageTags.Primary, 'Primary');
                        }
                    }
                    
                    const navItem = document.createElement('div');
                    navItem.className = 'category-nav-item';
                    navItem.onclick = () => openJellyfinCollection(collection.id);
                    
                    navItem.innerHTML = `
                        <img src="${backdropUrl}" 
                             alt="${collection.name}" 
                             class="category-nav-image"
                             loading="lazy">
                        <div class="category-nav-overlay">
                            <div class="category-nav-name">${collection.name}</div>
                        </div>
                    `;
                    
                    navScroll.appendChild(navItem);
                    
                } catch (error) {
                    console.error(`Error building nav for ${collection.name}:`, error);
                }
            }
            
            console.log('âœ… Category navigation built!');
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  LOAD CONTENT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function loadContent() {
            const container = document.getElementById('contentContainer');
            container.innerHTML = '<div class="loading-spinner"><div class="spinner"></div><div class="loading-text">Loading collections...</div></div>';
            
            console.log('ğŸ“š Loading collections...');
            
            let loadedCount = 0;
            const totalCollections = JELLYFIN_CONFIG.COLLECTIONS.length;
            
            for (const collection of JELLYFIN_CONFIG.COLLECTIONS) {
                // Skip 00 Collections - only show in category nav
                if (collection.name === '00 Collections') {
                    continue;
                }
                
                try {
                    loadedCount++;
                    
                    // Update loading text
                    const loadingText = container.querySelector('.loading-text');
                    if (loadingText) {
                        loadingText.textContent = `Loading ${collection.name}... (${loadedCount}/${totalCollections})`;
                    }
                    
                    console.log(`Loading: ${collection.name} (${loadedCount}/${totalCollections})`);
                    
                    const items = await jellyfinFetch(`/Users/${JELLYFIN_CONFIG.USER_ID}/Items`, {
                        ParentId: collection.id,
                        Limit: 50,
                        SortBy: 'SortName',
                        Recursive: true
                    });
                    
                    // Remove loading spinner on first collection
                    if (loadedCount === 1) {
                        container.innerHTML = '';
                    }
                    
                    // Create section even if empty
                    const section = document.createElement('section');
                    section.className = 'category-section';
                    section.id = `section-${collection.id}`;
                    section.setAttribute('data-collection-id', collection.id);
                    
                    // Create header
                    const header = document.createElement('div');
                    header.className = 'category-header';
                    header.innerHTML = `
                        <h3 class="category-title">${collection.name}</h3>
                        <a onclick="openJellyfinCollection('${collection.id}')" class="view-all-btn" style="cursor: pointer;">
                            View All <i class="fas fa-arrow-right"></i>
                        </a>
                    `;
                    
                    // Create carousel
                    const carousel = document.createElement('div');
                    carousel.className = 'content-carousel';
                    
                    // Add items to carousel or show empty message
                    if (items && items.Items && items.Items.length > 0) {
                        items.Items.forEach(item => {
                            // ONLY filter phantom images for "01 MOVIES 1" category
                            if (collection.name === '01 MOVIES 1') {
                                // Skip items that have NO image sources at all (likely TrickPlay orphans)
                                if (!item.ImageTags?.Primary && 
                                    !item.SeriesThumb && 
                                    !item.SeriesPrimaryImageTag && 
                                    !item.ParentThumbImageTag &&
                                    !item.BackdropImageTags) {
                                    console.log('â­ï¸ Skipping phantom item in Movie 1:', item.Name);
                                    return; // Skip this item
                                }
                            }
                            
                            const card = document.createElement('div');
                            card.className = 'content-card';
                            card.onclick = () => playJellyfinItem(item.Id);
                            
                            // Try multiple image sources for better compatibility
                            let imageUrl = 'https://placehold.co/200x300?text=No+Image';
                            
                            if (item.ImageTags?.Primary) {
                                imageUrl = getImageUrl(item.Id, item.ImageTags.Primary, 'Primary');
                            } else if (item.SeriesThumb) {
                                imageUrl = `${JELLYFIN_CONFIG.SERVER}/Items/${item.SeriesId}/Images/Thumb?api_key=${JELLYFIN_CONFIG.API_KEY}&format=webp&maxHeight=450`;
                            } else if (item.SeriesPrimaryImageTag && item.SeriesId) {
                                imageUrl = `${JELLYFIN_CONFIG.SERVER}/Items/${item.SeriesId}/Images/Primary?api_key=${JELLYFIN_CONFIG.API_KEY}&tag=${item.SeriesPrimaryImageTag}&format=webp&maxHeight=450`;
                            } else if (item.ParentThumbImageTag && item.ParentThumbItemId) {
                                imageUrl = `${JELLYFIN_CONFIG.SERVER}/Items/${item.ParentThumbItemId}/Images/Thumb?api_key=${JELLYFIN_CONFIG.API_KEY}&tag=${item.ParentThumbImageTag}&format=webp&maxHeight=450`;
                            }
                            
                            card.innerHTML = `
                                <img src="${imageUrl}" 
                                     alt="${item.Name}" 
                                     class="content-card-image" 
                                     loading="lazy"
                                     onerror="this.src='https://placehold.co/200x300?text=${encodeURIComponent(item.Name)}'">
                                <div class="content-card-overlay">
                                    <div class="content-card-title">${item.Name}</div>
                                    <div class="content-card-info">
                                        ${item.ProductionYear || ''} ${item.OfficialRating ? 'â€¢ ' + item.OfficialRating : ''}
                                    </div>
                                </div>
                            `;
                            
                            carousel.appendChild(card);
                        });
                        console.log(`âœ… Loaded ${items.Items.length} items from ${collection.name}`);
                    } else {
                        // Show empty state
                        carousel.innerHTML = '<div style="padding: 2rem; color: #94a3b8; text-align: center;">No content available yet. Check back soon!</div>';
                        console.log(`âš ï¸ ${collection.name} is empty`);
                    }
                    
                    section.appendChild(header);
                    section.appendChild(carousel);
                    container.appendChild(section);
                    
                } catch (error) {
                    console.error(`Error loading ${collection.name}:`, error);
                }
            }
            
            console.log('ğŸ‰ All content loaded!');
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  INITIALIZE APP
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Modal and Panel Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        function openPanel(panelId) {
            console.log('ğŸ”¥ Opening panel:', panelId);
            
            // Close other panels
            document.querySelectorAll('.side-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            const panel = document.getElementById(panelId);
            if (panel) {
                panel.classList.add('active');
                console.log('âœ… Panel opened:', panelId);
                
                // If opening chat panel, load saved username
                if (panelId === 'chatPanel') {
                    const savedUsername = localStorage.getItem('flmtvChatUsername');
                    const usernameInput = document.getElementById('chatUsernameInput');
                    if (savedUsername && usernameInput) {
                        usernameInput.value = savedUsername;
                    }
                }
            } else {
                console.error('âŒ Panel not found:', panelId);
            }
            
            // Push content left when panel opens
            document.body.classList.add('panel-active');
        }
        
        function closePanel(panelId) {
            const panel = document.getElementById(panelId);
            panel.classList.remove('active');
            panel.classList.remove('panel-fullscreen');  // Reset fullscreen when closing
            
            // Reset toggle button icon
            const toggleBtn = panel.querySelector('.panel-toggle i');
            if (toggleBtn) {
                toggleBtn.className = 'fas fa-expand';
            }
            
            // Remove body padding when panel closes
            document.body.classList.remove('panel-active');
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  PANEL FULLSCREEN TOGGLE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function togglePanelFullscreen(panelId) {
            const panel = document.getElementById(panelId);
            const toggleBtn = panel.querySelector('.panel-toggle i');
            
            if (panel.classList.contains('panel-fullscreen')) {
                // Exit fullscreen - back to side panel (450px)
                panel.classList.remove('panel-fullscreen');
                toggleBtn.className = 'fas fa-expand';
                console.log('âœ… Panel back to side mode:', panelId);
            } else {
                // Enter fullscreen - panel takes full width
                panel.classList.add('panel-fullscreen');
                toggleBtn.className = 'fas fa-compress';
                console.log('âœ… Panel fullscreen mode:', panelId);
            }
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  LIVE TV CONTROLS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        
        
        
        
        // Click outside modal to close
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.classList.remove('active');
            }
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  AUTO-AUTHENTICATE AS PUBLIC USER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function autoAuthenticatePublic() {
            try {
                console.log('ğŸ” Auto-authenticating as Public user...');
                
                const response = await fetch(`${JELLYFIN_CONFIG.SERVER}/Users/AuthenticateByName`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Emby-Authorization': `MediaBrowser Client="FLM Television Network", Device="Web Browser", DeviceId="flmtv-${Date.now()}", Version="1.0.0"`
                    },
                    body: JSON.stringify({
                        Username: 'Public',
                        Pw: ''
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('âœ… Auto-authenticated successfully!');
                    
                    // Store session in localStorage so Jellyfin web client can use it
                    const authData = {
                        AccessToken: data.AccessToken,
                        UserId: data.User.Id,
                        ServerId: JELLYFIN_CONFIG.SERVER
                    };
                    
                    // Try to set localStorage for Jellyfin domain
                    localStorage.setItem('jellyfin_credentials', JSON.stringify(authData));
                    
                    return true;
                } else {
                    console.log('âš ï¸ Auto-auth failed, user will need to login manually');
                    return false;
                }
            } catch (error) {
                console.log('âš ï¸ Auto-auth error:', error);
                return false;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ DOM loaded, starting app...');
            
            // FORCE preview video to be muted (especially on mobile!)
            const previewVideo = document.getElementById('previewVideo');
            if (previewVideo) {
                previewVideo.muted = true;
                previewVideo.volume = 0;
                
                // Extra enforcement for mobile
                previewVideo.setAttribute('muted', 'muted');
                previewVideo.setAttribute('playsinline', 'playsinline');
                
                // Prevent any unmute attempts
                previewVideo.addEventListener('volumechange', function() {
                    if (!this.muted) {
                        console.log('ğŸ”‡ Preview tried to unmute, forcing muted again');
                        this.muted = true;
                        this.volume = 0;
                    }
                });
                
                console.log('ğŸ”‡ Preview video LOCKED muted on load (mobile safe)');
            }
            
            // Auto-authenticate in background
            autoAuthenticatePublic();
            
            // Initialize hero banner slideshow
            initHeroBanner();
            
            // Live preview card - vMix Web Controller version
            // Stream shows when vMix is running on port 8088
            console.log('ğŸ“º Live TV card ready (vMix version)');
            
            
            // Attach button click handlers
            document.getElementById('signInBtn').onclick = () => openModal('signInModal');
            document.getElementById('parentLockBtn').onclick = () => openModal('parentLockModal');
            
            // Load content
            buildCategoryNav();
            loadContent();
            
            // AI Panel Functionality
            const aiButton = document.getElementById('aiSearchButton');
            const aiInput = document.getElementById('aiSearchInput');
            
            if (aiButton && aiInput) {
                aiButton.addEventListener('click', () => {
                    const query = aiInput.value.trim();
                    if (query) {
                        alert(`AI Search: "${query}"\n\nAI functionality will be connected soon!\n\nFor now, this is a placeholder.`);
                        console.log('ğŸ¤– AI Search:', query);
                    }
                });
                
                aiInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        aiButton.click();
                    }
                });
                
                console.log('âœ… AI panel ready');
            }
            
            // DEBUG: Log screen size for mobile testing
            console.log('ğŸ“± Screen width:', window.innerWidth);
            console.log('ğŸ“± Screen height:', window.innerHeight);
            console.log('ğŸ“± Device pixel ratio:', window.devicePixelRatio);
            console.log('ğŸ“± User agent:', navigator.userAgent);
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  HERO BANNER SLIDESHOW
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function initHeroBanner() {
            const heroBanner = document.getElementById('heroBanner');
            const slides = [];
            
            // Add your Zaina Show banner first
            slides.push({
                image: 'assets/images/ZainaShowTheaterBanner.jpg',
                title: 'The Zaina Juliette Show',
                description: 'A Contemporary variety/talk show hosted by Multi-Award-Winning Entertainer, Recording Artist, Actress, CREATOR OF FLM TV, Zaina Juliette, featuring celebrity guests and upcoming talent. "A Gumbo of Entertainment."',
                link: null
            });
            
            // Fetch featured content from Jellyfin
            try {
                const featured = await jellyfinFetch(`/Users/${JELLYFIN_CONFIG.USER_ID}/Items`, {
                    Limit: 4,
                    SortBy: 'Random',
                    Recursive: true,
                    IncludeItemTypes: 'Movie,Series',
                    ImageTypes: 'Backdrop'
                });
                
                if (featured && featured.Items) {
                    featured.Items.forEach(item => {
                        const backdropUrl = item.BackdropImageTags && item.BackdropImageTags[0]
                            ? getImageUrl(item.Id, item.BackdropImageTags[0], 'Backdrop')
                            : getImageUrl(item.Id, item.ImageTags.Primary, 'Primary');
                        
                        slides.push({
                            image: backdropUrl,
                            title: item.Name,
                            description: item.Overview || 'Stream now on FLM TV.',
                            link: item.Id
                        });
                    });
                }
            } catch (error) {
                console.error('Error loading featured content:', error);
            }
            
            // Build slides
            slides.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = `hero-slide ${index === 0 ? 'active' : ''}`;
                slideDiv.style.backgroundImage = `url('${slide.image}')`;
                
                const content = document.createElement('div');
                content.className = 'hero-content';
                content.innerHTML = `
                    <h2 class="hero-title">${slide.title}</h2>
                    <p class="hero-description">${slide.description}</p>
                    <div class="hero-buttons">
                        <button class="btn btn-hero-primary" onclick="${slide.link ? `playJellyfinItem('${slide.link}')` : `alert('Coming soon!')`}">
                            <i class="fas fa-play"></i> ${slide.link ? 'Watch Now' : 'Learn More'}
                        </button>
                    </div>
                `;
                
                slideDiv.appendChild(content);
                heroBanner.appendChild(slideDiv);
            });
            
            // Auto-rotate slides every 5 seconds
            let currentSlide = 0;
            setInterval(() => {
                const allSlides = heroBanner.querySelectorAll('.hero-slide');
                allSlides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % allSlides.length;
                allSlides[currentSlide].classList.add('active');
            }, 5000);
        }
        
        function playJellyfinItem(itemId) {
            const viewer = document.getElementById('jellyfinViewer');
            const frame = document.getElementById('jellyfinFrame');
            
            console.log('ğŸ¬ Opening Jellyfin detail page for:', itemId);
            
            // Load Jellyfin's detail page with API key - NO SIGN-IN!
            const detailUrl = `${JELLYFIN_CONFIG.SERVER}/web/index.html#!/details?id=${itemId}&api_key=${JELLYFIN_CONFIG.API_KEY}`;
            
            console.log('ğŸ”— Loading URL:', detailUrl);
            
            frame.src = detailUrl;
            
            // Inject FLM TV branding after iframe loads
            frame.onload = function() {
                try {
                    injectCustomBranding(frame);
                    // Start monitoring to keep Jellyfin UI hidden
                    startJellyfinUIMonitor(frame);
                } catch (e) {
                    console.log('Could not inject branding (CORS):', e);
                }
            };
            
            viewer.classList.add('active');
            viewer.classList.add('viewing-movie'); // Add this class for styling
            document.body.style.overflow = 'hidden';
            document.body.classList.add('video-playing');
            
            history.pushState({modal: 'movie'}, '', '#movie');
        }
        
        // Monitor and hide Jellyfin UI elements continuously
        let jellyfinMonitorInterval = null;
        
        function startJellyfinUIMonitor(frame) {
            // Clear any existing monitor
            if (jellyfinMonitorInterval) {
                clearInterval(jellyfinMonitorInterval);
            }
            
            // Monitor every 300ms (more frequent) to ensure Jellyfin UI stays hidden
            jellyfinMonitorInterval = setInterval(() => {
                try {
                    const doc = frame.contentDocument || frame.contentWindow.document;
                    if (doc) {
                        // Hide all possible header elements
                        const headersToHide = doc.querySelectorAll(`
                            .skinHeader, 
                            .skinHeader-withBackground,
                            .headerTop, 
                            .headerLeft, 
                            .headerRight, 
                            .headerLogo, 
                            .mainDrawer,
                            .viewMenuBar,
                            .mdl-layout__header,
                            [class*="header"],
                            [class*="Header"]
                        `);
                        
                        headersToHide.forEach(el => {
                            if (el && el.style.display !== 'none') {
                                el.style.display = 'none';
                                el.style.visibility = 'hidden';
                                el.style.height = '0';
                                el.style.overflow = 'hidden';
                                el.style.position = 'absolute';
                                el.style.top = '-9999px';
                            }
                        });
                        
                        // Target blue background elements (Jellyfin's blue header)
                        const allElements = doc.querySelectorAll('div');
                        allElements.forEach(el => {
                            const bgColor = window.getComputedStyle(el).backgroundColor;
                            // Check for Jellyfin's blue: rgb(0, 56, 168)
                            if (bgColor && (
                                bgColor.includes('0, 56, 168') || 
                                bgColor.includes('0,56,168') ||
                                bgColor === 'rgb(0, 56, 168)'
                            )) {
                                // Only hide if it's at the top of the page (likely a header)
                                const rect = el.getBoundingClientRect();
                                if (rect.top < 100) {
                                    el.style.display = 'none';
                                    el.style.visibility = 'hidden';
                                }
                            }
                        });
                        
                        // Ensure content starts at top
                        const mainPages = doc.querySelector('.mainAnimatedPages');
                        if (mainPages) {
                            mainPages.style.paddingTop = '0';
                            mainPages.style.marginTop = '0';
                            mainPages.style.top = '0';
                        }
                        
                        const view = doc.querySelector('.view');
                        if (view) {
                            view.style.paddingTop = '0';
                            view.style.marginTop = '0';
                        }
                    }
                } catch (e) {
                    // CORS error - ignore
                }
            }, 300); // Run every 300ms
        }
        
        function stopJellyfinUIMonitor() {
            if (jellyfinMonitorInterval) {
                clearInterval(jellyfinMonitorInterval);
                jellyfinMonitorInterval = null;
            }
        }
        
        async function openJellyfinCollection(collectionId) {
            console.log('ğŸ“‚ Opening Jellyfin collection page for:', collectionId);
            
            const viewer = document.getElementById('jellyfinViewer');
            const frame = document.getElementById('jellyfinFrame');
            
            if (!viewer || !frame) {
                console.error('âŒ Viewer or frame element not found');
                return;
            }
            
            const collection = JELLYFIN_CONFIG.COLLECTIONS.find(c => c.id === collectionId);
            const collectionName = collection ? collection.name : 'Collection';
            
            console.log('ğŸ“‚ Collection found:', collectionName);
            console.log('ğŸ“‚ Collection ID from config:', collectionId);
            console.log('ğŸ“‚ Collection URL from config:', collection?.url);
            
            // DIAGNOSTIC: Try fetching collection info from Jellyfin to verify it exists
            try {
                const collectionInfo = await jellyfinFetch(`/Users/${JELLYFIN_CONFIG.USER_ID}/Items/${collectionId}`, {});
                console.log('ğŸ“‚ Jellyfin says collection exists:', collectionInfo);
                console.log('ğŸ“‚ Collection Type:', collectionInfo.CollectionType);
                console.log('ğŸ“‚ Child Count:', collectionInfo.ChildCount);
            } catch (error) {
                console.error('âŒ ERROR: Cannot fetch collection from Jellyfin!', error);
                console.error('âŒ This collection ID might be invalid or deleted!');
            }
            
            // Load Jellyfin's native collection page with API key - NO SIGN-IN!
            let collectionUrl = collection && collection.url 
                ? collection.url 
                : `${JELLYFIN_CONFIG.SERVER}/web/index.html#!/list.html?parentId=${collectionId}`;
            
            // Fix URL format - change #/ to #!/ if needed
            collectionUrl = collectionUrl.replace('/web/#/', '/web/index.html#!/');
            
            // Ensure the URL keeps the :8920 port (not :8096)
            collectionUrl = collectionUrl.replace(':8096', ':8920');
            
            // IMPORTANT: For hash-based URLs, API key must go BEFORE the hash!
            // Split at the hash
            const hashIndex = collectionUrl.indexOf('#');
            if (hashIndex > -1) {
                const baseUrl = collectionUrl.substring(0, hashIndex);
                const hashPart = collectionUrl.substring(hashIndex);
                
                // Add api_key to base URL (before hash)
                if (!baseUrl.includes('api_key=')) {
                    const separator = baseUrl.includes('?') ? '&' : '?';
                    collectionUrl = baseUrl + separator + `api_key=${JELLYFIN_CONFIG.API_KEY}` + hashPart;
                }
            } else {
                // No hash, add normally
                if (!collectionUrl.includes('api_key=')) {
                    collectionUrl += (collectionUrl.includes('?') ? '&' : '?') + `api_key=${JELLYFIN_CONFIG.API_KEY}`;
                }
            }
            
            console.log('ğŸ”— Final URL we are loading:', collectionUrl);
            console.log('ğŸ”— Port check:', collectionUrl.includes(':8920') ? 'âœ… Correct port' : 'âŒ Wrong port!');
            console.log('ğŸ”— API key check:', collectionUrl.includes('api_key=') ? 'âœ… Has API key' : 'âŒ NO API KEY!');
            
            // Special handling for "00 Collections" - show Enter overlay
            if (collectionName === '00 Collections') {
                showCollectionsEnterOverlay(collectionUrl, collectionName);
            } else {
                // Load normally for other collections
                frame.src = collectionUrl;
                
                // Inject FLM TV branding after iframe loads
                frame.onload = function() {
                    console.log('âœ… Iframe loaded');
                    try {
                        injectCustomBranding(frame);
                        // Start monitoring to keep Jellyfin UI hidden
                        startJellyfinUIMonitor(frame);
                    } catch (e) {
                        console.log('Could not inject branding (CORS):', e);
                    }
                };
                
                viewer.classList.add('active');
                document.body.style.overflow = 'hidden';
                document.body.classList.add('video-playing');
                
                history.pushState({modal: 'collection'}, '', '#collection');
            }
        }
        
        function showCollectionsEnterOverlay(collectionUrl, collectionName) {
            const viewer = document.getElementById('jellyfinViewer');
            const frame = document.getElementById('jellyfinFrame');
            
            // Create beautiful enter overlay
            const overlay = document.createElement('div');
            overlay.id = 'collectionsEnterOverlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0038a8 100%);
                z-index: 99999;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.5s ease;
            `;
            
            overlay.innerHTML = `
                <style>
                    @keyframes fadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                    @keyframes glow {
                        0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
                        50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8); }
                    }
                    #collectionsEnterOverlay h1 {
                        font-size: 3rem;
                        font-weight: 900;
                        background: linear-gradient(135deg, #ffd700 0%, #22c55e 100%);
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        background-clip: text;
                        margin-bottom: 1rem;
                        text-align: center;
                    }
                    #collectionsEnterOverlay p {
                        color: #e2e8f0;
                        font-size: 1.25rem;
                        margin-bottom: 3rem;
                        text-align: center;
                    }
                    #collectionsEnterOverlay button {
                        background: linear-gradient(135deg, #ffd700 0%, #22c55e 100%);
                        border: none;
                        color: #000;
                        padding: 1.5rem 4rem;
                        font-size: 1.5rem;
                        font-weight: 900;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        animation: glow 2s infinite;
                        text-transform: uppercase;
                        letter-spacing: 2px;
                    }
                    #collectionsEnterOverlay button:hover {
                        transform: scale(1.05);
                        box-shadow: 0 0 50px rgba(255, 215, 0, 1);
                    }
                    @media (max-width: 768px) {
                        #collectionsEnterOverlay h1 { font-size: 2rem; }
                        #collectionsEnterOverlay p { font-size: 1rem; margin-bottom: 2rem; }
                        #collectionsEnterOverlay button { 
                            padding: 1rem 2.5rem; 
                            font-size: 1.25rem; 
                        }
                    }
                </style>
                <h1>ğŸŒŸ FLM TV Collections</h1>
                <p>Discover Popular & Trending Content</p>
                <button onclick="enterCollections()">ENTER COLLECTIONS</button>
            `;
            
            document.body.appendChild(overlay);
            
            // Make enter function globally accessible
            window.enterCollections = function() {
                // Remove overlay
                overlay.remove();
                
                // Load the Jellyfin collection page
                frame.src = collectionUrl;
                
                // Inject FLM TV branding and auto-click Public user
                frame.onload = function() {
                    console.log('âœ… Iframe loaded');
                    try {
                        injectCustomBranding(frame);
                        // Start monitoring to keep Jellyfin UI hidden
                        startJellyfinUIMonitor(frame);
                        
                        // Auto-click Public user after a delay
                        setTimeout(() => {
                            try {
                                const doc = frame.contentDocument || frame.contentWindow.document;
                                const publicUser = doc.querySelector('.card-usercard');
                                if (publicUser && publicUser.textContent.includes('Public')) {
                                    publicUser.click();
                                    console.log('âœ… Auto-clicked Public user');
                                    
                                    // Click submit button
                                    setTimeout(() => {
                                        const submitBtn = doc.querySelector('.button-submit');
                                        if (submitBtn) {
                                            submitBtn.click();
                                            console.log('âœ… Auto-submitted login');
                                        }
                                    }, 200);
                                }
                            } catch (e) {
                                console.log('Auto-login attempt:', e);
                            }
                        }, 1000);
                    } catch (e) {
                        console.log('Could not inject branding (CORS):', e);
                    }
                };
                
                viewer.classList.add('active');
                document.body.style.overflow = 'hidden';
                document.body.classList.add('video-playing');
                
                history.pushState({modal: 'collection'}, '', '#collection');
            };
        }
        
        function showSpaceWelcome() {
            // Create overlay
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0038a8 100%);
                z-index: 99999;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.5s ease;
            `;
            overlay.innerHTML = `
                <h1 style="font-size: 3rem; color: var(--accent); margin-bottom: 1rem; animation: glow 1.5s ease-in-out infinite;">
                    ğŸ›¸ Entering the 7th Realm ğŸ›¸
                </h1>
                <p style="font-size: 1.5rem; color: white;">Welcome to FLM Television Network</p>
            `;
            document.body.appendChild(overlay);
            
            // Auto-remove after 2 seconds
            setTimeout(() => {
                overlay.style.animation = 'fadeOut 0.5s ease';
                setTimeout(() => overlay.remove(), 500);
            }, 2000);
        }
        
        // Inject FLM TV branding into Jellyfin iframe
        function injectCustomBranding(frame) {
            const doc = frame.contentDocument || frame.contentWindow.document;
            
            // Fast auto-login - try immediately and repeatedly
            const autoLogin = () => {
                try {
                    const publicUser = doc.querySelector('.card-usercard');
                    if (publicUser && publicUser.textContent.includes('Public')) {
                        publicUser.click();
                        console.log('âœ… Auto-clicked Public user');
                        
                        setTimeout(() => {
                            const manualLoginBtn = doc.querySelector('.button-submit');
                            if (manualLoginBtn) {
                                manualLoginBtn.click();
                                console.log('âœ… Auto-submitted login');
                            }
                        }, 50);
                        return true;
                    }
                    return false;
                } catch (e) {
                    return false;
                }
            };
            
            // Try immediately
            autoLogin();
            
            // Keep trying every 100ms for 3 seconds
            let attempts = 0;
            const loginInterval = setInterval(() => {
                attempts++;
                if (autoLogin() || attempts >= 30) {
                    clearInterval(loginInterval);
                }
            }, 100);
            
            const style = doc.createElement('style');
            style.textContent = `
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                /*  HIDE JELLYFIN HEADER                                           */
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                
                .skinHeader,
                .skinHeader-withBackground,
                .headerTop,
                .headerLeft,
                .headerRight,
                .headerTabs,
                .headerUser,
                .headerUserButton,
                .headerBackButton,
                .headerCastButton,
                .headerSearchButton,
                .headerButton,
                .headerHomeButton,
                .headerLogo,
                .logoLibraryMenuButton,
                .btnNotifications,
                .mdl-layout__header,
                .viewMenuBar {
                    display: none !important;
                    visibility: hidden !important;
                    height: 0 !important;
                    opacity: 0 !important;
                }
                
                .mainDrawer,
                .navDrawer,
                .mdl-layout__drawer {
                    display: none !important;
                }
                
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                /*  HIDE LOGIN PAGE ONLY IF IT EXISTS                              */
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                
                /* Hide login page elements but keep them functional */
                .loginPage .readOnlyContent,
                .loginPage .visualLoginForm,
                .loginPage .manualLoginForm {
                    opacity: 0 !important;
                    transition: none !important;
                }
                
                /* Show loading message on login page only */
                .loginPage::before {
                    content: 'Loading...' !important;
                    position: fixed !important;
                    top: 50% !important;
                    left: 50% !important;
                    transform: translate(-50%, -50%) !important;
                    font-size: 1.5rem !important;
                    color: #fcd116 !important;
                    opacity: 1 !important;
                }
                
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                /*  ENSURE ALL CONTENT IS VISIBLE                                  */
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                
                /* Remove top spacing */
                .mainAnimatedPages,
                .view,
                .page,
                body {
                    padding-top: 0 !important;
                    margin-top: 0 !important;
                }
                
                /* ALL detail page content must be visible */
                .itemBackdrop,
                .detailImageContainer,
                .detailPagePrimaryContainer,
                .detailPageContent,
                .itemName,
                .overview,
                .detailButton,
                .sections,
                .itemsContainer,
                .card,
                .listItem,
                .emby-button,
                .btnPlay,
                .btnResume,
                .detailButtons,
                .episodesContainer,
                .emby-tab-button,
                .videoPlayerContainer,
                video,
                .osdControls {
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                }
                
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                /*  STYLING                                                         */
                /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
                
                body {
                    background: #0f172a !important;
                }
                
                .button-submit,
                .raised,
                .btnPlay {
                    background: linear-gradient(135deg, #ce1126 0%, #fcd116 100%) !important;
                    color: white !important;
                }
                
                .card {
                    background: #1e293b !important;
                }
                
                .card:hover {
                    border-color: #22c55e !important;
                }
            `;
            doc.head.appendChild(style);
            
            console.log('âœ… FLM TV branding applied');
        }
        
        function closeViewer() {
            // Stop monitoring Jellyfin UI
            stopJellyfinUIMonitor();
            
            const viewer = document.getElementById('jellyfinViewer');
            const frame = document.getElementById('jellyfinFrame');
            viewer.classList.remove('active');
            viewer.classList.remove('viewing-movie'); // Remove the class when closing
            frame.src = ''; // Clear the iframe
            document.body.style.overflow = ''; // Restore scrolling
            document.body.classList.remove('video-playing');
            
            // Close any open panels
            document.querySelectorAll('.side-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.body.classList.remove('panel-active');
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  CHAT FUNCTIONALITY
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');
        const emojiBtn = document.getElementById('emojiBtn');
        const emojiPicker = document.getElementById('emojiPicker');
        
        // AI Panel elements
        const aiChatInput = document.getElementById('aiChatInput');
        const aiSendBtn = document.getElementById('aiSendBtn');
        const aiMessages = document.getElementById('aiMessages');
        
        const emojis = ['ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†', 'ğŸ˜…', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ™‚', 'ğŸ™ƒ', 'ğŸ˜‰', 'ğŸ˜Œ', 'ğŸ˜', 'ğŸ¥°', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ˜‹', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ¤ª', 'ğŸ˜', 'ğŸ¤—', 'ğŸ¤­', 'ğŸ¤«', 'ğŸ¤”', 'ğŸ¤¨', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜’', 'ğŸ™„', 'ğŸ˜¬', 'ğŸ¤¥', 'ğŸ˜Œ', 'ğŸ˜”', 'ğŸ˜ª', 'ğŸ¤¤', 'ğŸ˜´', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•', 'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ¥´', 'ğŸ˜µ', 'ğŸ¤¯', 'ğŸ¤ ', 'ğŸ¥³', 'ğŸ˜', 'ğŸ¤“', 'ğŸ§', 'ğŸ˜•', 'ğŸ˜Ÿ', 'ğŸ™', 'ğŸ˜®', 'ğŸ˜¯', 'ğŸ˜²', 'ğŸ˜³', 'ğŸ¥º', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨', 'ğŸ˜©', 'ğŸ˜«', 'ğŸ˜¤', 'ğŸ˜ ', 'ğŸ˜¡', 'ğŸ¤¬', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ’€', 'ğŸ‘»', 'ğŸ’©', 'ğŸ¤¡', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ‘‹', 'ğŸ¤š', 'âœ‹', 'ğŸ‘Œ', 'âœŒï¸', 'ğŸ¤', 'ğŸ¤Ÿ', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ‘ˆ', 'ğŸ‘‰', 'ğŸ‘†', 'ğŸ‘‡', 'â˜ï¸', 'ğŸ‘', 'ğŸ‘', 'âœŠ', 'ğŸ‘Š', 'ğŸ‘', 'ğŸ™Œ', 'ğŸ‘', 'ğŸ¤²', 'ğŸ™', 'ğŸ’ª', 'â¤ï¸', 'ğŸ§¡', 'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ¤', 'ğŸ–¤', 'ğŸ¤', 'ğŸ’”', 'â£ï¸', 'ğŸ’•', 'ğŸ’', 'ğŸ’“', 'ğŸ’—', 'ğŸ’–', 'ğŸ’˜', 'ğŸ’', 'ğŸ”¥', 'ğŸ’§', 'ğŸ’¨', 'ğŸ¶', 'ğŸµ', 'ğŸ’¯'];
        
        // Populate emoji picker
        emojis.forEach(emoji => {
            const span = document.createElement('span');
            span.textContent = emoji;
            span.style.fontSize = '1.5em';
            span.style.cursor = 'pointer';
            span.style.padding = '0.2rem';
            span.style.borderRadius = '4px';
            span.addEventListener('click', () => insertEmoji(emoji));
            span.addEventListener('mouseenter', (e) => e.target.style.backgroundColor = '#3e3e3e');
            span.addEventListener('mouseleave', (e) => e.target.style.backgroundColor = 'transparent');
            emojiPicker.appendChild(span);
        });
        
        function addMessage(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + sender;
            messageDiv.style.marginBottom = '0.75rem';
            messageDiv.style.display = 'flex';
            messageDiv.style.alignItems = 'flex-start';
            messageDiv.style.justifyContent = sender === 'sent' ? 'flex-end' : 'flex-start';
            
            const messageBubble = document.createElement('div');
            messageBubble.className = 'message-bubble';
            messageBubble.style.maxWidth = '80%';
            messageBubble.style.padding = '0.6rem 0.9rem';
            messageBubble.style.borderRadius = '1rem';
            messageBubble.style.lineHeight = '1.4';
            messageBubble.style.wordWrap = 'break-word';
            messageBubble.style.backgroundColor = sender === 'sent' ? 'var(--secondary)' : '#333';
            messageBubble.style.color = 'white';
            messageBubble.style.borderBottomRightRadius = sender === 'sent' ? '0.25rem' : '1rem';
            messageBubble.style.borderBottomLeftRadius = sender === 'received' ? '0.25rem' : '1rem';
            
            // Support HTML content for AI visual responses
            if (text.includes('<div') || text.includes('<img')) {
                messageBubble.innerHTML = text;
            } else {
                messageBubble.textContent = text;
            }
            
            messageDiv.appendChild(messageBubble);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function addAIMessage(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + sender;
            messageDiv.style.marginBottom = '0.75rem';
            messageDiv.style.display = 'flex';
            messageDiv.style.alignItems = 'flex-start';
            messageDiv.style.justifyContent = sender === 'sent' ? 'flex-end' : 'flex-start';
            
            const messageBubble = document.createElement('div');
            messageBubble.className = 'message-bubble';
            messageBubble.style.maxWidth = '80%';
            messageBubble.style.padding = '0.6rem 0.9rem';
            messageBubble.style.borderRadius = '1rem';
            messageBubble.style.lineHeight = '1.4';
            messageBubble.style.wordWrap = 'break-word';
            messageBubble.style.backgroundColor = sender === 'sent' ? 'var(--secondary)' : '#333';
            messageBubble.style.color = 'white';
            messageBubble.style.borderBottomRightRadius = sender === 'sent' ? '0.25rem' : '1rem';
            messageBubble.style.borderBottomLeftRadius = sender === 'received' ? '0.25rem' : '1rem';
            
            // Support HTML content for AI visual responses
            if (text.includes('<div') || text.includes('<img')) {
                messageBubble.innerHTML = text;
            } else {
                messageBubble.textContent = text;
            }
            
            messageDiv.appendChild(messageBubble);
            aiMessages.appendChild(messageDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;
        }

        function sendMessage() {
            const messageText = chatInput.value.trim();
            const sendBtn = document.getElementById('sendBtn');
            
            if (messageText !== '') {
                // Clear input immediately
                chatInput.value = '';
                chatInput.style.height = 'auto';
                
                // Get username from input field
                const usernameInput = document.getElementById('chatUsernameInput');
                let username = usernameInput.value.trim();
                
                // If no username entered, require it
                if (!username) {
                    usernameInput.focus();
                    usernameInput.style.border = '2px solid #ce1126'; // Red border
                    setTimeout(() => {
                        usernameInput.style.border = '1px solid #444';
                    }, 2000);
                    alert('Please enter your name first!');
                    chatInput.value = messageText; // Restore message
                    return;
                }
                
                // Show sending state
                sendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                sendBtn.disabled = true;
                sendBtn.style.opacity = '0.6';
                
                // Save username to localStorage
                localStorage.setItem('flmtvChatUsername', username);
                
                // Get user ID (Firebase or fallback)
                const user = auth.currentUser;
                const userId = user ? user.uid : fallbackUserId;
                
                // Send to Firebase with username
                console.log('ğŸ“¤ Sending message to Firebase...');
                console.log('Username:', username);
                console.log('Message:', messageText);
                console.log('Firebase Database URL:', database.ref().toString());
                
                database.ref('messages').push({
                    text: messageText,
                    username: username,
                    userId: userId,
                    timestamp: Date.now()
                }).then(() => {
                    console.log('âœ… Message sent successfully!');
                    // Reset button
                    sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                }).catch((error) => {
                    console.error('âŒ Firebase error:', error);
                    alert('Chat error: ' + error.message);
                    // Reset button
                    sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                    sendBtn.disabled = false;
                    sendBtn.style.opacity = '1';
                    // Show message locally as fallback
                    addMessage('sent', messageText);
                });
            }
        }
        
        function sendAIMessage() {
            const messageText = aiChatInput.value.trim();
            if (messageText !== '') {
                addAIMessage('sent', messageText);
                aiChatInput.value = '';
                aiChatInput.style.height = 'auto';
                
                // Send to Zaina AI
                handleAIMessage(messageText);
            }
        }
        
        function insertEmoji(emoji) {
            chatInput.value += emoji;
            emojiPicker.style.display = 'none';
            chatInput.focus();
        }
        
        if (emojiBtn && sendBtn && chatInput) {
            emojiBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                emojiPicker.style.display = emojiPicker.style.display === 'flex' ? 'none' : 'flex';
            });
            
            document.addEventListener('click', (e) => {
                if (!emojiPicker.contains(e.target) && e.target !== emojiBtn) {
                    emojiPicker.style.display = 'none';
                }
            });
            
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Send button - both click AND touch for mobile
            sendBtn.addEventListener('click', sendMessage);
            sendBtn.addEventListener('touchend', (e) => {
                e.preventDefault(); // Prevent double-firing
                sendMessage();
            });
        }
        
        // AI Chat event listeners
        if (aiSendBtn && aiChatInput) {
            aiChatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendAIMessage();
                }
            });

            aiSendBtn.addEventListener('click', sendAIMessage);
            
            console.log('âœ… AI chat ready');
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  ZAINA AI - INTELLIGENT ASSISTANT WITH VISUAL SEARCH
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function handleAIMessage(query) {
            try {
                console.log('ğŸ¤– Zaina AI (Coming Soon):', query);
                
                // TEMPORARY: Coming Soon message
                addAIMessage('received', 'ğŸŒŸ Zaina AI is coming soon! We\'re working on bringing you the best AI assistant for FLM TV. In the meantime, feel free to use the live chat below to connect with other viewers! ğŸ’š');
                
                return;
                
                /* DISABLED TEMPORARILY - Will re-enable when backend is ready
                
                console.log('ğŸ¤– Zaina AI processing:', query);
                
                // Detect if this is a movie/TV search (contains words like: movie, film, show, actor, series, watch)
                const isEntertainmentQuery = /\b(movie|film|show|actor|actress|series|watch|episode|season|tv|director|star|cast)\b/i.test(query);
                
                if (isEntertainmentQuery) {
                    // Try TMDB for movie/TV searches
                    const tmdbResponse = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEYS.TMDB}&query=${encodeURIComponent(query)}`);
                    const tmdbData = await tmdbResponse.json();
                    
                    if (tmdbData.results && tmdbData.results.length > 0) {
                        // Visual search results
                        let visualResponse = '<div style="margin: 10px 0;">';
                        
                        tmdbData.results.slice(0, 3).forEach(item => {
                            const posterUrl = item.poster_path 
                                ? `https://image.tmdb.org/t/p/w200${item.poster_path}`
                                : 'https://placehold.co/200x300?text=No+Poster';
                            
                            const title = item.title || item.name;
                            const year = item.release_date ? `(${item.release_date.substring(0, 4)})` : 
                                         item.first_air_date ? `(${item.first_air_date.substring(0, 4)})` : '';
                            
                            visualResponse += `
                                <div style="margin-bottom: 15px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; border: 1px solid var(--neon-green);">
                                    <img src="${posterUrl}" style="width: 100%; border-radius: 8px; margin-bottom: 10px;">
                                    <strong style="color: var(--accent);">${title} ${year}</strong><br>
                                    <small style="color: var(--text-secondary);">${item.overview ? item.overview.substring(0, 150) + '...' : 'No description available'}</small><br>
                                    <small style="color: var(--neon-green);">â­ ${item.vote_average ? item.vote_average.toFixed(1) : 'N/A'}/10</small>
                                </div>
                            `;
                        });
                        
                        visualResponse += '</div>';
                        addAIMessage('received', visualResponse);
                        return; // Exit early if we found results
                    }
                }
                
                // Use OpenAI ChatGPT for ALL questions
                console.log('ğŸ¤– Using AI Gateway for OpenAI query:', query);
                
                // AI Gateway will automatically intercept this call
                const aiResponse = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' // Netlify AI Gateway sets this automatically
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are Zaina AI, a friendly and knowledgeable assistant for FLM Television Network. You can answer questions about entertainment, current events, people, places, and general knowledge. Be conversational, helpful, and concise (2-4 sentences unless more detail is needed).'
                            },
                            {
                                role: 'user',
                                content: query
                            }
                        ],
                        max_tokens: 500
                    })
                });
                
                console.log('ğŸ“¥ Response status:', aiResponse.status, aiResponse.statusText);
                
                if (!aiResponse.ok) {
                    const errorText = await aiResponse.text();
                    console.error('âŒ AI Error:', errorText);
                    addAIMessage('received', `API Error (${aiResponse.status}): Unable to connect to AI. Please try again later.`);
                    return;
                }
                
                const aiData = await aiResponse.json();
                console.log('ğŸ¤– Full response:', JSON.stringify(aiData, null, 2));
                
                const aiText = aiData.choices?.[0]?.message?.content;
                
                if (aiText) {
                    console.log('âœ… AI response received:', aiText.substring(0, 100));
                    addAIMessage('received', aiText);
                } else {
                    console.error('âŒ No response text');
                    addAIMessage('received', 'I had trouble understanding that. Could you rephrase your question? ğŸ’š');
                }
                
                */ // End of disabled AI code
                
            } catch (err) {
                console.error('âŒ AI Error:', err);
                addAIMessage('received', 'ğŸŒŸ Zaina AI is coming soon! ğŸ’š');
            }
        }
        
        // Track displayed messages to prevent duplicates
        const displayedMessages = new Set();
        
        // Listen to Firebase chat messages - YOUTUBE STYLE (everyone sees everything)
        database.ref('messages').limitToLast(50).on('child_added', (snapshot) => {
            const messageId = snapshot.key;
            const msg = snapshot.val();
            
            // Prevent duplicate messages
            if (displayedMessages.has(messageId)) {
                return;
            }
            displayedMessages.add(messageId);
            
            // Show ALL messages to EVERYONE (like YouTube live chat)
            if (msg && msg.text) {
                const username = msg.username || `Viewer${msg.userId ? msg.userId.substring(0, 6) : '???'}`;
                
                // Check if this is from current user
                let isOwnMessage = false;
                const savedUsername = localStorage.getItem('flmtvChatUsername');
                if (savedUsername && msg.username === savedUsername) {
                    isOwnMessage = true;
                } else if (auth.currentUser && msg.userId === auth.currentUser.uid) {
                    isOwnMessage = true;
                }
                
                // Add message with username
                const messagesContainer = document.getElementById('chatMessages');
                if (messagesContainer) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message ' + (isOwnMessage ? 'sent' : 'received');
                    messageDiv.style.marginBottom = '0.75rem';
                    messageDiv.style.display = 'flex';
                    messageDiv.style.flexDirection = 'column';
                    messageDiv.style.alignItems = isOwnMessage ? 'flex-end' : 'flex-start';
                    
                    const messageBubble = document.createElement('div');
                    messageBubble.className = 'message-bubble';
                    messageBubble.style.maxWidth = '80%';
                    messageBubble.style.padding = '0.6rem 0.9rem';
                    messageBubble.style.borderRadius = '1rem';
                    messageBubble.style.lineHeight = '1.4';
                    messageBubble.style.wordWrap = 'break-word';
                    messageBubble.style.backgroundColor = isOwnMessage ? 'var(--secondary)' : '#333';
                    messageBubble.style.color = 'white';
                    messageBubble.style.borderBottomRightRadius = isOwnMessage ? '0.25rem' : '1rem';
                    messageBubble.style.borderBottomLeftRadius = isOwnMessage ? '1rem' : '0.25rem';
                    
                    // Show username for all messages (YouTube style)
                    messageBubble.innerHTML = `
                        <div style="font-weight: 700; color: var(--accent); margin-bottom: 0.25rem; font-size: 0.85rem;">
                            ${username}
                        </div>
                        <div>${escapeHtml(msg.text)}</div>
                    `;
                    
                    messageDiv.appendChild(messageBubble);
                    messagesContainer.appendChild(messageDiv);
                    
                    // Auto-scroll to bottom (like YouTube)
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    
                    console.log('ğŸ’¬ Message displayed:', username, msg.text);
                }
            }
        });
        
        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  ZAINA AI - YouTube Search (EXACT CODE from working admin dashboard)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function searchYouTube() {
            const query = document.getElementById("lumaSearch").value;
            const resultDiv = document.getElementById("lumaResults");
            resultDiv.innerHTML = "ğŸ” Searching...";
            const apiKey = API_KEYS.YOUTUBE;

            const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&maxResults=5&key=${apiKey}`;
            const res = await fetch(url);
            const data = await res.json();

            resultDiv.innerHTML = "";
            if (data.items) {
                data.items.forEach((item) => {
                    const videoId = item.id.videoId;
                    const title = item.snippet.title;
                    const thumb = item.snippet.thumbnails.medium.url;
                    const desc = item.snippet.description;

                    const div = document.createElement("div");
                    div.innerHTML = `
                        <div style='margin-bottom: 15px; padding: 10px; border: 1px solid #333; background: #1f1f1f; border-radius: 8px;'>
                            <img src="${thumb}" style="width: 200px; float: left; margin-right: 15px; border-radius: 6px;">
                            <strong style="color: var(--accent);">${title}</strong><br><br>
                            <small style="color: var(--text-secondary);">${desc}</small><br><br>
                            <a href="http://youtube.com/watch?v=${videoId}" target="_blank" style="color: var(--neon-green); text-decoration: none;">
                                â–¶ Watch on YouTube
                            </a>
                            <div style='clear:both;'></div>
                        </div>`;
                    resultDiv.appendChild(div);
                });
            } else {
                resultDiv.innerHTML = "âŒ No results found.";
            }
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  LIVE CHANNEL 26.5 HLS STREAMING
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        let hls = null;
        
        // Toggle preview video volume
        function togglePreviewVolume() {
            const video = document.getElementById('previewVideo');
            const btn = document.getElementById('volumeToggleBtn');
            const icon = btn.querySelector('i');
            
            if (video.muted) {
                video.muted = false;
                icon.className = 'fas fa-volume-up';
                btn.classList.add('unmuted');
                btn.title = 'Mute';
                console.log('ğŸ”Š Preview audio unmuted');
            } else {
                video.muted = true;
                icon.className = 'fas fa-volume-mute';
                btn.classList.remove('unmuted');
                btn.title = 'Unmute';
                console.log('ğŸ”‡ Preview audio muted');
            }
        }
        
        function openLiveStream() {
            console.log('ğŸ”´ Opening Live Channel 26.5...');
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('liveStreamVideo');
            if (!modal || !video) {
                console.warn('Live stream modal/video element not found.');
                return;
            }

            // âœ… Public HTTPS HLS URL (served by Caddy -> Python HLS)
            const streamUrl = 'https://flmtv26.duckdns.org/hls/FLMTV.m3u8';

            modal.classList.add('active');

            // Clean previous playback
            try { video.pause(); } catch(e) {}
            video.removeAttribute('src');
            try { video.load(); } catch(e) {}

            // Destroy previous HLS instance if any
            if (window.__flmHls) {
                try { window.__flmHls.destroy(); } catch(e) {}
                window.__flmHls = null;
            }

            // iOS Safari supports native HLS
            const canPlayNative = video.canPlayType('application/vnd.apple.mpegurl') || video.canPlayType('application/x-mpegURL');
            if (canPlayNative) {
                video.src = streamUrl;
                video.play().catch(() => {});
            } else if (window.Hls && Hls.isSupported()) {
                const hls = new Hls({
                    enableWorker: true,
                    lowLatencyMode: true,
                    backBufferLength: 90,
                    maxBufferLength: 30,
                    maxMaxBufferLength: 600,
                    startLevel: -1,
                    debug: false
                });
                window.__flmHls = hls;
                hls.loadSource(streamUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    video.play().catch(() => {});
                });
                hls.on(Hls.Events.ERROR, (event, data) => {
                    console.warn('HLS error', data);
                });
            } else {
                // Fallback: direct src (some browsers might still attempt)
                video.src = streamUrl;
                video.play().catch(() => {});
            }

            // Add #stream to history so Back works
            if (window.location.hash !== '#stream') {
                history.pushState({ page: 'stream' }, '', '#stream');
            }
        }
        
        function closeLiveStream() {
            console.log('â¹ï¸ Closing live stream...');
            const modal = document.getElementById('videoModal');
            modal.classList.remove('active');
            // Remove from history
            if (window.location.hash === '#stream') {
                history.back();
            }
        }
        
        // Handle browser back button
        window.addEventListener('popstate', function(event) {
            const videoModal = document.getElementById('videoModal');
            const jellyfinViewer = document.getElementById('jellyfinViewer');
            
            // Close video modal if open
            if (videoModal && videoModal.classList.contains('active')) {
                videoModal.classList.remove('active');
            }
            
            // Close Jellyfin viewer if open
            if (jellyfinViewer && jellyfinViewer.classList.contains('active')) {
                jellyfinViewer.classList.remove('active');
                const frame = document.getElementById('jellyfinFrame');
                if (frame) frame.src = '';
            }
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //  PASSWORD TOGGLE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
        
    
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âœ… FIX: "View All" (NO Jellyfin Web, NO login/logo flash)
// Uses Jellyfin API only + in-page navigation
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let activeCollectionId = null;
let activeCollectionName = null;

function openCollectionInline(collectionId, collectionName) {
  activeCollectionId = collectionId;
  activeCollectionName = collectionName || 'Collection';
  // push state so browser back works
  try { history.pushState({ page: 'collection', id: collectionId }, '', `?collectionId=${encodeURIComponent(collectionId)}`); } catch(e){}
  loadCollectionPage(collectionId, activeCollectionName);
}

window.addEventListener('popstate', (e) => {
  const params = new URLSearchParams(location.search);
  const cid = params.get('collectionId');
  if (cid) {
    loadCollectionPage(cid, activeCollectionName || 'Collection');
  } else {
    // back to normal browse
    activeCollectionId = null;
    activeCollectionName = null;
    if (typeof renderAllRows === 'function') renderAllRows();
  }
});

async function loadCollectionPage(collectionId, title) {
  // You should already have a main grid/container; we reuse the existing "allMoviesGrid" if present
  const grid = document.getElementById('allMoviesGrid') || document.getElementById('moviesGrid') || document.querySelector('.movies-grid');
  const heading = document.getElementById('pageTitle') || document.querySelector('h1') || null;

  if (heading) heading.textContent = title || 'Collection';
  if (!grid) { console.warn('No grid found to render collection'); return; }

  grid.innerHTML = `<div style="padding:20px;color:#94a3b8;">Loading ${title || 'collection'}â€¦</div>`;

  try {
    const url = `/Users/${JELLYFIN_CONFIG.USER_ID}/Items?ParentId=${encodeURIComponent(collectionId)}&Recursive=true&IncludeItemTypes=Movie,Series,Episode&Fields=PrimaryImageAspectRatio,PremiereDate,ProductionYear,RunTimeTicks,Overview&SortBy=SortName&SortOrder=Ascending`;
    const data = await jellyfinFetch(url);

    const items = (data && data.Items) ? data.Items : [];
    if (!items.length) {
      grid.innerHTML = `<div style="padding:20px;color:#94a3b8;">No items found in this collection.</div>`;
      return;
    }

    // Reuse your existing card renderer if you have one
    if (typeof createMovieCard === 'function') {
      grid.innerHTML = '';
      items.forEach(item => grid.appendChild(createMovieCard(item)));
      return;
    }

    // Fallback simple renderer
    grid.innerHTML = items.map(item => {
      const name = (item.Name || 'Untitled').replace(/"/g,'&quot;');
      const img = item.ImageTags && item.ImageTags.Primary
        ? `${JELLYFIN_CONFIG.SERVER}/Items/${item.Id}/Images/Primary?tag=${item.ImageTags.Primary}&quality=90&api_key=${JELLYFIN_CONFIG.API_KEY}`
        : '';
      return `
        <div style="width:180px;margin:10px;display:inline-block;vertical-align:top;">
          <div style="width:180px;height:270px;border-radius:12px;overflow:hidden;background:#111827;border:1px solid rgba(255,255,255,.08);">
            ${img ? `<img src="${img}" alt="${name}" style="width:100%;height:100%;object-fit:cover;">` : ''}
          </div>
          <div style="margin-top:8px;color:#e2e8f0;font-weight:700;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${name}</div>
        </div>`;
    }).join('');
  } catch (err) {
    console.error(err);
    grid.innerHTML = `<div style="padding:20px;color:#f87171;">Error loading collection.</div>`;
  }
}

</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!--  BOTTOM NAVIGATION (Mobile Only - Like Hulu)                    -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<nav class="bottom-nav">
    <a href="#home" class="bottom-nav-item active">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
    <button class="bottom-nav-item" onclick="openPanel('chatPanel')">
        <i class="fas fa-comments"></i>
        <span>Chat</span>
    </button>
    <button class="bottom-nav-item" onclick="openLiveStream()">
        <i class="fas fa-tv"></i>
        <span>Live TV</span>
    </button>
    <button class="bottom-nav-item" onclick="openPanel('aiPanel')">
        <img class="nav-avatar" src="assets/images/z-ai-avatar2.png" alt="Zaina AI">
        <span>Zaina AI</span>
    </button>
</nav>

</body>
</html>